<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>åŠ å¯†ğŸ” - æ ‡ç­¾ - è°·ä¸­ä»çš„åšå®¢</title><link>https://guzhongren.github.io/tags/%E5%8A%A0%E5%AF%86/</link><description>åŠ å¯†ğŸ” - æ ‡ç­¾ - è°·ä¸­ä»çš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>guzhongren@live.cn (è°·ä¸­ä»)</managingEditor><webMaster>guzhongren@live.cn (è°·ä¸­ä»)</webMaster><copyright>Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Sun, 12 Jul 2020 11:00:42 +0800</lastBuildDate><atom:link href="https://guzhongren.github.io/tags/%E5%8A%A0%E5%AF%86/" rel="self" type="application/rss+xml"/><item><title>How to Encrypt Git Files</title><link>https://guzhongren.github.io/2020/07/how-to-encrypt-git-files/</link><pubDate>Sun, 12 Jul 2020 11:00:42 +0800</pubDate><author>è°·ä¸­ä»</author><guid>https://guzhongren.github.io/2020/07/how-to-encrypt-git-files/</guid><description><![CDATA[<div class="featured-image">
                <img src="https://s1.ax1x.com/2020/07/12/U32INn.png" referrerpolicy="no-referrer">
            </div><h2 id="ä¸ºä»€ä¹ˆéœ€è¦-crypt">ä¸ºä»€ä¹ˆéœ€è¦ crypt</h2>
<p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š</p>
<blockquote>
<p>æ€ä¹ˆå°†æ•æ„Ÿæ•°æ®è®©ç‰¹å®šçš„äººè·å–åˆ°ï¼Ÿ</p></blockquote>
<p>å¸¸ç”¨çš„è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li>ä½¿ç”¨å¦‚ AWS çš„ KMS, ParameterStore ç­‰æœåŠ¡ï¼Œç»™ä¸åŒçš„ç”¨æˆ·ä»¥è®¿é—®è¯¥æ•°æ®çš„è§’è‰²ï¼›</li>
<li>æœ‰ä¸“äººæ‰˜ç®¡ï¼Œåœ¨éœ€è¦çš„æ—¶å€™è”ç³»ä»–ï¼Œç”±ç‰¹å®šæ–¹å¼è½¬å‘ç»™ä½ ï¼Œå¦‚åŠ å¯†é‚®ä»¶ç­‰</li>
</ul>
<h3 id="åˆ†æ">åˆ†æ</h3>
<ul>
<li>å¯¹äºç¬¬äºŒç§æ–¹å¼ï¼Œç›¸å¯¹ç®€å•ç²—æš´ï¼Œä½†æ˜¯ä¸åˆ©äºç®¡ç†ã€‚</li>
<li>ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œä½ éœ€è¦ä¾æ‰˜ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œä½ å¾—ç»å¯¹ä¿¡ä»»ä»–ï¼Œç›¸ä¿¡ä»–æ˜¯ä¸ä¼šå‡ºé—®é¢˜çš„ï¼›å†è€…ï¼Œä½ çš„æ•°æ®ç®¡ç†ä¹Ÿéœ€è¦æœ‰ç‰¹å®šçš„è§„èŒƒï¼Œä¸ç„¶ä½ éƒ½ä¸çŸ¥é“ä½ å­˜å‚¨äº†ä»€ä¹ˆæ•°æ®ï¼Œæ›´ä¸çŸ¥é“æœ‰å“ªäº›æ•°æ®ã€‚</li>
</ul>
<p>é’ˆå¯¹ç¬¬ä¸€ç§æƒ…å†µï¼Œå½“æˆ‘ä»¬çš„æ•°æ®è¶Šæ¥å¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶çŠ¶æ€å¯æ§èµ·æ¥ï¼Œå…¶å®å°±æ˜¯ <code>date as code</code>, æ¯æ¬¡å¯¹æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æœ‰è¿½è¸ªå’Œæ•°æ®ä¿å­˜ã€‚</p>
<h2 id="æœ‰å“ªäº›æ–¹æ¡ˆå‘¢">æœ‰å“ªäº›æ–¹æ¡ˆå‘¢ï¼Ÿ</h2>
<ul>
<li><a href="https://github.com/AGWA/git-crypt">git-crypt</a><sup>[1]</sup>
</li>
<li><a href="https://github.com/elasticdog/transcrypt">transcrypt</a><sup>[2]</sup>
</li>
</ul>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘æ¨èä½¿ç”¨ <code>git-crypt</code>, å…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>åŠ å¯†åä¸Šä¼  gitï¼Œåœ¨ git ä¸Šä¿å­˜çš„æ˜¯<code>äºŒè¿›åˆ¶</code>æ–‡ä»¶ï¼›</li>
<li>åˆ†å‘<code>å¯†é’¥</code>ç»™å¯ä¿¡å¼€å‘äººå‘˜ï¼Œè¿›è¡Œè§£å¯†ï¼Œç»´æŠ¤é…ç½®æ–‡ä»¶ï¼›</li>
<li>è§£å¯†åä¸ºæ˜æ–‡å†…å®¹ï¼Œå¦‚éœ€ä¸Šä¼ ï¼Œä¸ç”¨å†è¿›è¡ŒåŠ å¯†ï¼Œå·¥å…·<code>è‡ªåŠ¨</code>ï¼ˆé…åˆ<code>git hook</code>) ä¼šç”Ÿæˆæœ€æ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶åä¸Šä¼ ï¼›</li>
<li>ç”±<code>c++</code>ç¼–å†™ï¼›</li>
<li>Mac å¯ä»¥é€šè¿‡<code>brew ç­‰</code>æ–¹å¼ä¸‹è½½ï¼›</li>
<li>åˆ©ç”¨äº†åŠ å¯†å·¥å…·<code>gpg</code>è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚</li>
</ul>
<h3 id="gpg">GPG</h3>
<p><img src="https://ruanyifeng.com/blogimg/asset/201307/bg2013071202.png" alt="GPG" /></p>
<p>è¦äº†è§£ä»€ä¹ˆæ˜¯ GPGï¼Œå°±è¦å…ˆäº†è§£ PGPã€‚</p>
<p>1991 å¹´ï¼Œç¨‹åºå‘˜ Phil Zimmermann ä¸ºäº†é¿å¼€æ”¿åºœç›‘è§†ï¼Œå¼€å‘äº†åŠ å¯†è½¯ä»¶ PGPã€‚è¿™ä¸ªè½¯ä»¶éå¸¸å¥½ç”¨ï¼Œè¿…é€Ÿæµä¼ å¼€æ¥ï¼Œæˆäº†è®¸å¤šç¨‹åºå‘˜çš„å¿…å¤‡å·¥å…·ã€‚ä½†æ˜¯ï¼Œå®ƒæ˜¯å•†ä¸šè½¯ä»¶ï¼Œä¸èƒ½è‡ªç”±ä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œè‡ªç”±è½¯ä»¶åŸºé‡‘ä¼šå†³å®šï¼Œå¼€å‘ä¸€ä¸ª PGP çš„æ›¿ä»£å“ï¼Œå–åä¸º GnuPGã€‚è¿™å°±æ˜¯ GPG çš„ç”±æ¥ã€‚</p>
<p>gpg å¯ä»¥å¯¹å¯†é’¥çš„<code>å¢åˆ æ”¹æŸ¥</code>è¿›è¡Œæ“ä½œï¼Œä¹Ÿå¯ä»¥å°†å…¬é’¥å‘é€åˆ° pgp ç­‰æœåŠ¡å™¨ï¼Œè®©åˆ«äººæœç´¢åˆ°ä½ ï¼Œå…·ä½“æ“ä½œå¯ä»¥å‚è€ƒé˜®ä¸€å³°çš„è¿™ç‰‡åšæ–‡ <a href="https://ruanyifeng.com/blog/2013/07/gpg.html">ã€ŠGPG å…¥é—¨æ•™ç¨‹ã€‹</a><sup>[3]</sup>
</p>
<h2 id="git-crypt-æ“ä½œ">git-crypt æ“ä½œ</h2>
<h3 id="å®‰è£…-gpg-å’Œ-git-crypt">å®‰è£… gpg å’Œ git-crypt</h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">brew install git-crypt
</span></span><span class="line"><span class="cl">brew install gpg</span></span></code></pre></div></div>
<h3 id="gpg-version">gpg version</h3>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gpg --version
</span></span><span class="line"><span class="cl">gpg <span class="o">(</span>GnuPG<span class="o">)</span> 2.2.19
</span></span><span class="line"><span class="cl">libgcrypt 1.8.5
</span></span><span class="line"><span class="cl">Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">2019</span> Free Software Foundation, Inc.
</span></span><span class="line"><span class="cl">License GPLv3+: GNU GPL version <span class="m">3</span> or later &lt;https://gnu.org/licenses/gpl.html&gt;
</span></span><span class="line"><span class="cl">This is free software: you are free to change and redistribute it.
</span></span><span class="line"><span class="cl">There is NO WARRANTY, to the extent permitted by law.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Home: /Users/c4/.gnupg
</span></span><span class="line"><span class="cl">æ”¯æŒçš„ç®—æ³•ï¼š
</span></span><span class="line"><span class="cl">å…¬é’¥ï¼š RSA, ELG, DSA, ECDH, ECDSA, EDDSA
</span></span><span class="line"><span class="cl">å¯†æ–‡ï¼š IDEA, 3DES, CAST5, BLOWFISH, AES, AES192, AES256, TWOFISH,
</span></span><span class="line"><span class="cl">    CAMELLIA128, CAMELLIA192, CAMELLIA256
</span></span><span class="line"><span class="cl">æ•£åˆ—ï¼š SHA1, RIPEMD160, SHA256, SHA384, SHA512, SHA224
</span></span><span class="line"><span class="cl">å‹ç¼©ï¼š  ä¸å‹ç¼©ï¼ŒZIP, ZLIB, BZIP2</span></span></code></pre></div></div>
<h3 id="ç”Ÿæˆ-gpg-userid">ç”Ÿæˆ gpg userId</h3>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gpg --full-generate-key
</span></span><span class="line"><span class="cl">gpg <span class="o">(</span>GnuPG<span class="o">)</span> 2.2.19<span class="p">;</span> Copyright <span class="o">(</span>C<span class="o">)</span> <span class="m">2019</span> Free Software Foundation, Inc.
</span></span><span class="line"><span class="cl">This is free software: you are free to change and redistribute it.
</span></span><span class="line"><span class="cl">There is NO WARRANTY, to the extent permitted by law.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¯·é€‰æ‹©æ‚¨è¦ä½¿ç”¨çš„å¯†é’¥ç±»å‹ï¼š
</span></span><span class="line"><span class="cl">   <span class="o">(</span>1<span class="o">)</span> RSA å’Œ RSA ï¼ˆé»˜è®¤ï¼‰
</span></span><span class="line"><span class="cl">   <span class="o">(</span>2<span class="o">)</span> DSA å’Œ Elgamal
</span></span><span class="line"><span class="cl">   <span class="o">(</span>3<span class="o">)</span> DSAï¼ˆä»…ç”¨äºç­¾åï¼‰
</span></span><span class="line"><span class="cl">   <span class="o">(</span>4<span class="o">)</span> RSAï¼ˆä»…ç”¨äºç­¾åï¼‰
</span></span><span class="line"><span class="cl">  <span class="o">(</span>14<span class="o">)</span> Existing key from card
</span></span><span class="line"><span class="cl">æ‚¨çš„é€‰æ‹©æ˜¯ï¼Ÿ
</span></span><span class="line"><span class="cl">RSA å¯†é’¥çš„é•¿åº¦åº”åœ¨ <span class="m">1024</span> ä½ä¸ <span class="m">4096</span> ä½ä¹‹é—´ã€‚
</span></span><span class="line"><span class="cl">æ‚¨æƒ³è¦ä½¿ç”¨çš„å¯†é’¥é•¿åº¦ï¼Ÿ<span class="o">(</span>2048<span class="o">)</span> <span class="m">4096</span>
</span></span><span class="line"><span class="cl">è¯·æ±‚çš„å¯†é’¥é•¿åº¦æ˜¯ <span class="m">4096</span> ä½
</span></span><span class="line"><span class="cl">è¯·è®¾å®šè¿™ä¸ªå¯†é’¥çš„æœ‰æ•ˆæœŸé™ã€‚
</span></span><span class="line"><span class="cl">         <span class="nv">0</span> <span class="o">=</span> å¯†é’¥æ°¸ä¸è¿‡æœŸ
</span></span><span class="line"><span class="cl">      &lt;n&gt;  <span class="o">=</span> å¯†é’¥åœ¨ n å¤©åè¿‡æœŸ
</span></span><span class="line"><span class="cl">      &lt;n&gt;w <span class="o">=</span> å¯†é’¥åœ¨ n å‘¨åè¿‡æœŸ
</span></span><span class="line"><span class="cl">      &lt;n&gt;m <span class="o">=</span> å¯†é’¥åœ¨ n æœˆåè¿‡æœŸ
</span></span><span class="line"><span class="cl">      &lt;n&gt;y <span class="o">=</span> å¯†é’¥åœ¨ n å¹´åè¿‡æœŸ
</span></span><span class="line"><span class="cl">å¯†é’¥çš„æœ‰æ•ˆæœŸé™æ˜¯ï¼Ÿ<span class="o">(</span>0<span class="o">)</span>
</span></span><span class="line"><span class="cl">å¯†é’¥æ°¸è¿œä¸ä¼šè¿‡æœŸ
</span></span><span class="line"><span class="cl">è¿™äº›å†…å®¹æ­£ç¡®å—ï¼Ÿ <span class="o">(</span>y/N<span class="o">)</span> y
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">GnuPG éœ€è¦æ„å»ºç”¨æˆ·æ ‡è¯†ä»¥è¾¨è®¤æ‚¨çš„å¯†é’¥ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">çœŸå®å§“åï¼š guzhongren
</span></span><span class="line"><span class="cl">ç”µå­é‚®ä»¶åœ°å€ï¼š guzhongren@live.cn
</span></span><span class="line"><span class="cl">æ³¨é‡Šï¼š guzhongren
</span></span><span class="line"><span class="cl">æ‚¨é€‰å®šäº†æ­¤ç”¨æˆ·æ ‡è¯†ï¼š
</span></span><span class="line"><span class="cl">    â€œguzhongren <span class="o">(</span>guzhongren<span class="o">)</span> &lt;guzhongren@live.cn&gt;â€
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ›´æ”¹å§“åï¼ˆNï¼‰ã€æ³¨é‡Šï¼ˆCï¼‰ã€ç”µå­é‚®ä»¶åœ°å€ï¼ˆEï¼‰æˆ–ç¡®å®šï¼ˆOï¼‰/é€€å‡ºï¼ˆQï¼‰ï¼Ÿ o
</span></span><span class="line"><span class="cl">æˆ‘ä»¬éœ€è¦ç”Ÿæˆå¤§é‡çš„éšæœºå­—èŠ‚ã€‚åœ¨è´¨æ•°ç”ŸæˆæœŸé—´åšäº›å…¶ä»–æ“ä½œï¼ˆæ•²æ‰“é”®ç›˜
</span></span><span class="line"><span class="cl">ã€ç§»åŠ¨é¼ æ ‡ã€è¯»å†™ç¡¬ç›˜ä¹‹ç±»çš„ï¼‰å°†ä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„ä¸»æ„ï¼›è¿™ä¼šè®©éšæœºæ•°
</span></span><span class="line"><span class="cl">å‘ç”Ÿå™¨æœ‰æ›´å¥½çš„æœºä¼šè·å¾—è¶³å¤Ÿçš„ç†µã€‚
</span></span><span class="line"><span class="cl">æˆ‘ä»¬éœ€è¦ç”Ÿæˆå¤§é‡çš„éšæœºå­—èŠ‚ã€‚åœ¨è´¨æ•°ç”ŸæˆæœŸé—´åšäº›å…¶ä»–æ“ä½œï¼ˆæ•²æ‰“é”®ç›˜
</span></span><span class="line"><span class="cl">ã€ç§»åŠ¨é¼ æ ‡ã€è¯»å†™ç¡¬ç›˜ä¹‹ç±»çš„ï¼‰å°†ä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„ä¸»æ„ï¼›è¿™ä¼šè®©éšæœºæ•°
</span></span><span class="line"><span class="cl">å‘ç”Ÿå™¨æœ‰æ›´å¥½çš„æœºä¼šè·å¾—è¶³å¤Ÿçš„ç†µã€‚
</span></span><span class="line"><span class="cl">gpg: å¯†é’¥ 25DD25A47AEF036A è¢«æ ‡è®°ä¸ºç»å¯¹ä¿¡ä»»
</span></span><span class="line"><span class="cl">gpg: åŠé”€è¯ä¹¦å·²è¢«å­˜å‚¨ä¸ºâ€˜/Users/c4/.gnupg/openpgp-revocs.d/4FA612D2DB4244E7D64A1C1025DD25A47AEF036A.revâ€™
</span></span><span class="line"><span class="cl">å…¬é’¥å’Œç§é’¥å·²ç»ç”Ÿæˆå¹¶è¢«ç­¾åã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pub   rsa4096 2020-07-11 <span class="o">[</span>SC<span class="o">]</span>
</span></span><span class="line"><span class="cl">      4FA612D2DB4244E7D64A1C1025DD25A47AEF036A
</span></span><span class="line"><span class="cl">uid                      guzhongren <span class="o">(</span>guzhongren<span class="o">)</span> &lt;guzhongren@live.cn&gt;
</span></span><span class="line"><span class="cl">sub   rsa4096 2020-07-11 <span class="o">[</span>E<span class="o">]</span></span></span></code></pre></div></div>
<h3 id="è·å–-userid">è·å– UserID</h3>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">gpg --list-secret-keys --keyid-format LONG
</span></span><span class="line"><span class="cl">gpg: æ­£åœ¨æ£€æŸ¥ä¿¡ä»»åº¦æ•°æ®åº“
</span></span><span class="line"><span class="cl">gpg: ç»å¯¹ä¿¡ä»»å¯†é’¥ 8823E362E95562B8 çš„å…¬é’¥æœªæ‰¾åˆ°
</span></span><span class="line"><span class="cl">gpg: marginals needed: <span class="m">3</span>  completes needed: <span class="m">1</span>  trust model: pgp
</span></span><span class="line"><span class="cl">gpg: æ·±åº¦ï¼š0  æœ‰æ•ˆæ€§ï¼š  <span class="m">4</span>  å·²ç­¾åï¼š  <span class="m">0</span>  ä¿¡ä»»åº¦ï¼š0-ï¼Œ0qï¼Œ0nï¼Œ0mï¼Œ0fï¼Œ4u
</span></span><span class="line"><span class="cl">gpg: ä¸‹æ¬¡ä¿¡ä»»åº¦æ•°æ®åº“æ£€æŸ¥å°†äº 2022-01-26 è¿›è¡Œ
</span></span><span class="line"><span class="cl">/Users/c4/.gnupg/pubring.kbx
</span></span><span class="line"><span class="cl">----------------------------
</span></span><span class="line"><span class="cl">sec   rsa4096/25DD25A47AEF036A 2020-07-11 <span class="o">[</span>SC<span class="o">]</span>
</span></span><span class="line"><span class="cl">      4FA612D2DB4244E7D64A1C1025DD25A47AEF036A
</span></span><span class="line"><span class="cl">uid                 <span class="o">[</span> ç»å¯¹ <span class="o">]</span> guzhongren <span class="o">(</span>guzhongren<span class="o">)</span> &lt;guzhongren@live.cn&gt;
</span></span><span class="line"><span class="cl">ssb   rsa4096/DCC72940818AB355 2020-07-11 <span class="o">[</span>E<span class="o">]</span></span></span></code></pre></div></div>
<p><code>sec   rsa4096/25DD25A47AEF036A 2020-07-11 [SC]</code> ä¸­ <code>25DD25A47AEF036A</code>å°±æ˜¯ gpg userId</p>
<h2 id="git-crypt-æ“ä½œ-1">git-crypt æ“ä½œ</h2>
<h3 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h3>
<p>è¿›å…¥éœ€è¦åšåŠ å¯†çš„ git repo åš git-crypt åˆå§‹åŒ–æ“ä½œï¼Œå¹¶å°†ä¸Šé¢è·å–åˆ°çš„ gpg userId æ·»åŠ è¿›å»</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git-crypt init
</span></span><span class="line"><span class="cl">git-crypt add-gpg-user 25DD25A47AEF036A</span></span></code></pre></div></div>
<h3 id="åŠ å¯†æ–‡ä»¶è¿‡æ»¤å™¨gitattributes">åŠ å¯†æ–‡ä»¶è¿‡æ»¤å™¨<code>.gitattributes</code></h3>
<p>æ ¼å¼ä¸ºï¼š * filter=git-crypt diff=git-crypt ï¼›å¦‚ä¸‹ï¼Œæˆ‘éœ€è¦åŠ å¯†<code>secretfile</code>, <code>*.key</code>å’Œ<code>secretdir/**</code>, é‚£ä¹ˆå†…å®¹å¦‚ä¸‹ï¼š</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>secretfile filter=git-crypt diff=git-crypt
*.key filter=git-crypt diff=git-crypt
secretdir/** filter=git-crypt diff=git-crypt</code></pre></div>
<h3 id="æ¸…ç†-config-çš„-git-ç¼“å­˜">æ¸…ç† config çš„ git ç¼“å­˜</h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git rm -r â€“cached config</span></span></code></pre></div></div>
<h3 id="æ·»åŠ éœ€è¦åŠ å¯†çš„æ–‡ä»¶å’Œæ•°æ®">æ·»åŠ éœ€è¦åŠ å¯†çš„æ–‡ä»¶å’Œæ•°æ®</h3>
<p>åœ¨<code>secretdir</code>æ–‡ä»¶å¤¹ä¸‹æ·»åŠ  <code>secret.yaml</code>, å¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-yaml">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">username:password</span></span></span></code></pre></div></div>
<h3 id="ä¸Šä¼ åˆ°-git-ä»“åº“">ä¸Šä¼ åˆ° git ä»“åº“</h3>
<p>æ­¤æ­¥ä¸ç”¨æ‹…å¿ƒä½ çš„<code>secret.yaml</code>æ–‡ä»¶ä»¥æ˜æ–‡çš„å½¢å¼ä¸Šä¼ ï¼Œgit-crypt ä¼šåœ¨ commit ä¹‹å‰å°†è¿‡æ»¤åçš„æ•°æ®åŠ å¯†æˆäºŒè¿›åˆ¶ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒåœ¨ä»“åº“ä¸­å­˜å‚¨æ•æ„Ÿä¿¡æ¯ã€‚</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m â€˜git-cryptâ€™
</span></span><span class="line"><span class="cl">git push</span></span></code></pre></div></div>
<p>å¦‚æœä½ å» git ä»“åº“ä¸­æµè§ˆ secret.yaml æ–‡ä»¶ï¼Œä¼šæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¦‚å›¾ï¼š</p>
<p><img src="https://i.loli.net/2020/07/12/lXVnNw5EbKCcvhe.png" alt="git-crypt.png" /></p>
<h2 id="åä½œ">åä½œ</h2>
<p>ä¸ä»–äººåä½œï¼Œåˆ«äººéœ€è¦çŸ¥é“å¯¹åº”è§£å¯†çš„ key</p>
<h3 id="å¯¼å‡ºå¯†é’¥">å¯¼å‡ºå¯†é’¥</h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git-crypt export-key ~/Desktop/git-crypt.key</span></span></code></pre></div></div>
<p>å¾—åˆ° git-crypt.key åï¼Œå°†è¯¥å¯†é’¥åˆ†å‘ç»™å¯ä¿¡çš„å›¢é˜Ÿæˆå‘˜ï¼Œå›¢é˜Ÿæˆå‘˜å°†ä»“åº“ clone ä¸‹æ¥åï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è§£å¯†å³å¯</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git-crypt unlock /path/to/git-crypt.key</span></span></code></pre></div></div>
<p>æ­¤æ—¶ï¼Œåœ¨æœ¬åœ°å°±å¯ä»¥çœ‹åˆ°åŠ å¯†åçš„æ–‡ä»¶å†…å®¹äº†ã€‚</p>
<h3 id="æ›´æ–°å¯†é’¥">æ›´æ–°å¯†é’¥</h3>
<p>å› ä¸º git-crypt æ²¡æœ‰æä¾›åˆ é™¤æˆ–è€…æ›´æ–°å¯†é’¥çš„å‘½ä»¤ï¼Œæ‰€ä»¥å‚è€ƒäº†ä¸€ä¸ª issue: <a href="https://github.com/AGWA/git-crypt/issues/47#issuecomment-492939759;">https://github.com/AGWA/git-crypt/issues/47#issuecomment-492939759;</a><sup>[4]</sup>
 æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>Make a backup (with decrypted files): cp -r . /path/to/backup</li>
<li>Save a list of files that are encrypted: git crypt status | grep -v &rsquo;not encrypted&rsquo; &gt; ../encrypted-files.txt</li>
<li>Make git-crypt forget about itself: rm .git-crypt</li>
<li>Delete the encrypted files: awk &lsquo;{print $2}&rsquo; ../encrypted-files.txt | xargs rm</li>
<li>Commit (at this point you get a repo without git-crypt stuff)</li>
<li>Add git-crypt from scratch (init and add-gpg-user)</li>
<li>Copy the decrypted files from the backup: awk &lsquo;{print $2}&rsquo; ../encrypted-files.txt | while read l; do cp /path/to/backup/$l $l; done</li>
<li>Commit (at this point you are done, but be sure to verify things are properly encrypted before publishing)</li>
</ul>
<p>å®è·µç»“æœï¼šåœ¨æ›´æ–°å®Œæˆä¹‹åï¼Œåä½œè€…éœ€è¦é‡æ–° clone ä»“åº“ï¼Œç„¶åç”¨æ–°çš„å¯†é’¥æ¥è§£å¯†ï¼Œå¯¹å¯†é’¥ç®¡ç†è€…æ¥è¯´æ“ä½œæ¯”è¾ƒéº»çƒ¦</p>
<h3 id="æ€»ç»“">æ€»ç»“</h3>
<p>åœ¨æ•æ„Ÿæ•°æ®è¶Šæ¥è¶Šå¤šçš„æ—¶å€™ï¼Œä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬æ›´åº”è¯¥å°†æ‰€æœ‰çš„æ•°æ®éƒ½<code>as code</code>, ä¸ºä»¥åç»´æŠ¤æä¾›æ–¹ä¾¿ã€‚<code>git-crypt</code>ç¡®å®æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚</p>
<p>ä½†æ˜¯<code>git-crypt</code>æœ‰ä¸€ä¸ªæœ€å¤§çš„ç¼ºç‚¹ï¼š</p>
<ul>
<li>åªèƒ½æ·»åŠ ä¸èƒ½åˆ é™¤ gpg userId, å¯¼è‡´æ›´æ–°å¯†é’¥ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœè¦æ›´æ–°å¯†é’¥ï¼Œé‚£ä¹ˆå°±éœ€è¦åšé‡ç½®</li>
</ul>
<div class="references">
                <h2>å‚è€ƒ</h2>
                <ol><li>git-crypt: <a href="https://github.com/AGWA/git-crypt" rel="noopener noreferrer">https://github.com/AGWA/git-crypt</a></li><li>transcrypt: <a href="https://github.com/elasticdog/transcrypt" rel="noopener noreferrer">https://github.com/elasticdog/transcrypt</a></li><li>ã€ŠGPG å…¥é—¨æ•™ç¨‹ã€‹: <a href="https://ruanyifeng.com/blog/2013/07/gpg.html" rel="noopener noreferrer">https://ruanyifeng.com/blog/2013/07/gpg.html</a></li><li>https://github.com/AGWA/git-crypt/issues/47#issuecomment-492939759;: <a href="https://github.com/AGWA/git-crypt/issues/47#issuecomment-492939759;" rel="noopener noreferrer">https://github.com/AGWA/git-crypt/issues/47#issuecomment-492939759;</a></li></ol>
            </div>]]></description></item></channel></rss>