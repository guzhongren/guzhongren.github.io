<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Rust - æ ‡ç­¾ - è°·ä¸­ä»çš„åšå®¢</title><link>https://guzhongren.github.io/tags/rust/</link><description>Rust - æ ‡ç­¾ - è°·ä¸­ä»çš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>guzhongren@live.cn (è°·ä¸­ä»)</managingEditor><webMaster>guzhongren@live.cn (è°·ä¸­ä»)</webMaster><copyright>Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Sat, 06 Jun 2020 11:03:11 +0800</lastBuildDate><atom:link href="https://guzhongren.github.io/tags/rust/" rel="self" type="application/rss+xml"/><item><title>Cargo è¿è¡Œå‡ºé”™åŠè§£å†³æ–¹æ¡ˆ</title><link>https://guzhongren.github.io/2020/06/cargo%E8%BF%90%E8%A1%8C%E5%87%BA%E9%94%99%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</link><pubDate>Sat, 06 Jun 2020 11:03:11 +0800</pubDate><author>è°·ä¸­ä»</author><guid>https://guzhongren.github.io/2020/06/cargo%E8%BF%90%E8%A1%8C%E5%87%BA%E9%94%99%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</guid><description><![CDATA[<div class="featured-image">
                <img src="https://images.unsplash.com/photo-1591414855728-7e70d9a7b4e0?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=1267&amp;q=80" referrerpolicy="no-referrer">
            </div><h2 id="é—®é¢˜">é—®é¢˜</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">â¯ cargo run
</span></span><span class="line"><span class="cl">error: failed to run <span class="sb">`</span>rustc<span class="sb">`</span> to learn about target-specific information
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Caused by:
</span></span><span class="line"><span class="cl">  process didn<span class="err">&#39;</span>t <span class="nb">exit</span> successfully: <span class="sb">`</span>rustc - --crate-name ___ --print<span class="o">=</span>file-names -Zprofile -Ccodegen-units<span class="o">=</span><span class="m">1</span> -Copt-level<span class="o">=</span><span class="m">0</span> -Clink-dead-code -Coverflow-checks<span class="o">=</span>off -Zpanic_abort_tests -Cpanic<span class="o">=</span>abort --crate-type bin --crate-type rlib --crate-type dylib --crate-type cdylib --crate-type staticlib --crate-type proc-macro --print<span class="o">=</span>sysroot --print<span class="o">=</span>cfg<span class="sb">`</span> <span class="o">(</span><span class="nb">exit</span> code: 1<span class="o">)</span>
</span></span><span class="line"><span class="cl">--- stderr
</span></span><span class="line"><span class="cl">error: the option <span class="sb">`</span>Z<span class="sb">`</span> is only accepted on the nightly compiler<span class="sb">`</span></span></span></code></pre></div></div>
<p>æœ€è¿‘æ›´æ–°äº†<code>rust</code>, ç„¶åè¿è¡Œ<code>cargo run</code>, è«åå…¶å¦™çš„å‡ºç°äº†ä¸Šé¢çš„é—®é¢˜ã€‚</p>
<h2 id="åŸå› ">åŸå› </h2>
<p>åœ¨ rust å®˜ç½‘çš„ issue é‡Œæ‰¾è§£å†³æ–¹æ¡ˆï¼Œéƒ½æ˜¯ open çŠ¶æ€çš„ï¼Œæ²¡æœ‰å®é™…æ„ä¹‰ã€‚é‚£ä¹ˆå°±å¾—å›åˆ°åŸå§‹æ–¹å¼ã€‚
æŒ‰ç…§æç¤ºï¼Œè¯´<code>Z</code> è¿™ä¸ªå‚æ•°ä»…é€‚ç”¨äº<code>nightly</code>ç‰ˆæœ¬çš„ rust ç¼–è¯‘å™¨ï¼Œä½†æ˜¯æˆ‘ç”¨çš„æ˜¯<code>stable</code>ç‰ˆæœ¬çš„ rust;</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">â¯ rustup show
</span></span><span class="line"><span class="cl">Default host: x86_64-apple-darwin
</span></span><span class="line"><span class="cl">rustup home:  /Users/c4/.rustup
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">stable-x86_64-apple-darwin <span class="o">(</span>default<span class="o">)</span>
</span></span><span class="line"><span class="cl">rustc 1.44.0 <span class="o">(</span>49cae5576 2020-06-01<span class="o">)</span></span></span></code></pre></div></div>
<p>ç‰ˆæœ¬ç¡®å®šï¼Œé‚£ä¹ˆåªèƒ½å°†è¯­éŸ³å½’ç»“åˆ°å‘½ä»¤è¡ŒæŸä¸ªåœ°æ–¹æœ‰æ³¨å…¥å‚æ•°ã€‚ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å°±æ˜¯ç¯å¢ƒå˜é‡ï¼Œæ‰“å¼€æˆ‘çš„<code>~/.zshrc</code>, æœç„¶åœ¨æœ€ä¸‹é¢æ‰¾åˆ°äº†è¿™ä¹ˆä¸€æ¡è®°å½•ï¼Œçœ‹åˆ°<code>-Z</code>, åº”è¯¥å°±æ˜¯ä»–äº†ã€‚</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">RUSTFLAGS</span><span class="o">=</span><span class="s2">&#34;-Zprofile -Ccodegen-units=1 -Copt-level=0 -Clink-dead-code -Coverflow-checks=off -Zpanic_abort_tests -Cpanic=abort&#34;</span></span></span></code></pre></div></div>
<h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h2>
<p>åˆ é™¤è¯¥è¡Œè®°å½•ï¼Œè¿è¡Œç¨‹åºï¼ŒæˆåŠŸè¾“å‡º<code>hello world</code>ã€‚</p>
<h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<ul>
<li><a href="https://guzhongren.github.io/" target="_blank" rel="noopener noreffer ">1. åšå®¢ï¼šhttps://guzhongren.github.io/</a></li>
<li><a href="https://sm.ms/" target="_blank" rel="noopener noreffer ">2. å›¾åºŠï¼šhttps://sm.ms/</a></li>
<li><a href="https://github.com/mozilla/grcov/issues/433" target="_blank" rel="noopener noreffer ">3. grcov</a></li>
</ul>
<h2 id="å…è´£å£°æ˜">å…è´£å£°æ˜</h2>
<p>æœ¬æ–‡ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œä¸æœ¬äººæ‰€ä¾›èŒçš„å…¬å¸æ— ä»»ä½•å…³ç³»ã€‚</p>
<hr>
<p></p>
]]></description></item><item><title>Rust Doc å°è®°</title><link>https://guzhongren.github.io/2020/04/rust-doc%E5%B0%8F%E8%AE%B0.zh/</link><pubDate>Thu, 16 Apr 2020 22:56:55 +0800</pubDate><author>è°·ä¸­ä»</author><guid>https://guzhongren.github.io/2020/04/rust-doc%E5%B0%8F%E8%AE%B0.zh/</guid><description><![CDATA[<div class="featured-image">
                <img src="https://i.loli.net/2020/04/16/nBq8Zc2u3IV7Pmf.jpg" referrerpolicy="no-referrer">
            </div><h2 id="å‰è¨€">å‰è¨€</h2>
<p>å­¦ä¹  Rust è‚¯å®šç¦»ä¸å¼€æŸ¥çœ‹å…¶å®˜æ–¹æˆ–è€…ç¬¬ä¸‰æ–¹å¼€å‘è€…çš„æ–‡æ¡£ï¼Œè€Œåœ¨ Rust çš„ crate ä¸­ï¼Œå¯¹äºå¼€å‘è€…æˆ–è€…ä½¿ç”¨è€…ï¼Œæ–‡æ¡£æ˜¯éå¸¸å‹å¥½çš„ã€‚åœ¨è¿™å°±ä¸ä¸¾ä¾‹äº†ã€‚æœ¬æ–‡ä¸»è¦æ˜¯è®°å½•ä¸€ä¸‹å†™ rust doc çš„ä¸€äº›å°æ­¥éª¤ã€‚æ–¹ä¾¿æ—¥åæŸ¥é˜…ã€‚</p>
<h2 id="ç¤ºä¾‹">ç¤ºä¾‹</h2>
<h3 id="ç”Ÿæˆé¡¹ç›®">ç”Ÿæˆé¡¹ç›®</h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ cargo new mylib --lib</span></span></code></pre></div></div>
<h3 id="ç¼–å†™-librs-ä¸­çš„å®ç°">ç¼–å†™ lib.rs ä¸­çš„å®ç°</h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-rust">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">add_one</span><span class="p">(</span><span class="n">x</span>: <span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></div></div>
<h3 id="ä¸º-add_one-æ·»åŠ æ³¨é‡Š">ä¸º add_one æ·»åŠ æ³¨é‡Š</h3>
<p>æœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š</p>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-rust">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="sd">//! My Crate name
</span></span></span><span class="line"><span class="cl"><span class="sd">//!
</span></span></span><span class="line"><span class="cl"><span class="sd">//! `my_crate_name` is test for studying
</span></span></span><span class="line"><span class="cl"><span class="sd">/// Add one for the number given
</span></span></span><span class="line"><span class="cl"><span class="sd">///
</span></span></span><span class="line"><span class="cl"><span class="sd">/// #Example
</span></span></span><span class="line"><span class="cl"><span class="sd">///
</span></span></span><span class="line"><span class="cl"><span class="sd">/// ```rust
</span></span></span><span class="line"><span class="cl"><span class="sd">///let five = 5
</span></span></span><span class="line"><span class="cl"><span class="sd">///assert_eq!(6, rust_study::add_one(five));
</span></span></span><span class="line"><span class="cl"><span class="sd">/// ```
</span></span></span><span class="line"><span class="cl"><span class="sd">///
</span></span></span><span class="line"><span class="cl"><span class="sd"></span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">add_one</span><span class="p">(</span><span class="n">x</span>: <span class="kt">i32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">i32</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></div></div>
<h3 id="ç”Ÿæˆ-rust-æ ‡å‡†æ–‡æ¡£å¹¶æŸ¥çœ‹">ç”Ÿæˆ rust æ ‡å‡†æ–‡æ¡£å¹¶æŸ¥çœ‹</h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ cargo doc --open</span></span></code></pre></div></div>
<p>æ‰§è¡Œå¦‚ä¸Šå‘½ä»¤ï¼Œcargo ä¼šæ ¹æ®æ³¨é‡Šç”Ÿæˆ web ç½‘é¡µæ–‡æ¡£ï¼Œå¹¶ä¸”è‡ªåŠ¨æ‰“å¼€ï¼Œå¦‚ä¸‹æ˜¯ä¸Šé¢æ–‡æ¡£ç”Ÿæˆçš„ç»“æœã€‚</p>
<p></p>
<p></p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<ul>
<li>Rust ä¸­å†™çš„æ³¨é‡Šä»£ç ï¼Œå¯ä»¥ç”¨æ¥åšæ–¹æ³•ç¤ºä¾‹ï¼Œæˆ–è€…å½“ä½œæµ‹è¯•ï¼Œå¦‚æœæ˜¯æµ‹è¯•ï¼Œè¿è¡Œ<code>cargo test</code>	, cargo	ä¸ä»…ä¼šæµ‹è¯• tests æ–‡ä»¶å¤¹ä¸‹çš„æµ‹è¯•æ¡ˆä¾‹ï¼Œè¿˜ä¼šå¯»æ‰¾æ³¨é‡Šä¸­çš„æµ‹è¯•ã€‚</li>
<li>ä»€ä¹ˆæ—¶å€™å†™æ³¨é‡Šå‘¢ï¼Ÿä¼˜ç§€çš„ç¨‹åºå‘˜æ€»æ˜¯å¼ºè°ƒæ–¹æ³•åå³æ³¨é‡Šç­‰ã€‚ä½†æœ‰ä¸ç¡®å®šçš„æ—¶å€™å°±å¾—å†™æ³¨é‡Šå•¦ã€‚
<ul>
<li>åœ¨ rust ä¸­ï¼Œåœ¨ç¨‹åºä¼š panic çš„æ—¶å€™éœ€è¦å†™æ³¨é‡Šå‘Šè¯‰è°ƒç”¨è€…å¯èƒ½ panic çš„æ–¹æ³•</li>
<li>è¿”å›å€¼æ˜¯ Result ç±»å‹çš„æ—¶å€™ï¼Œéœ€è¦å‘Šè¯‰è°ƒç”¨è€…ï¼ŒOk å’Œ Err çš„æ•°æ®ä¼šæ˜¯ä»€ä¹ˆ</li>
</ul>
</li>
</ul>
<p>Rust çš„ç¼–è¯‘å™¨ç›¸å½“ä¸¥è°¨ï¼Œç»“åˆ TDD å†™ä»£ç åº”è¯¥ä¼šå¾ˆçˆ½ã€‚</p>
<h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<ul>
<li><a href="https://guzhongren.github.io/" target="_blank" rel="noopener noreffer ">1. åšå®¢ï¼šhttps://guzhongren.github.io/</a></li>
<li><a href="https://sm.ms/" target="_blank" rel="noopener noreffer ">2. å›¾åºŠï¼šhttps://sm.ms/</a></li>
</ul>
<h2 id="å…è´£å£°æ˜">å…è´£å£°æ˜</h2>
<p>æœ¬æ–‡ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œä¸æœ¬äººæ‰€ä¾›èŒçš„å…¬å¸æ— ä»»ä½•å…³ç³»ã€‚</p>
<hr>
<p></p>
]]></description></item><item><title>Rust ä¸­é—­åŒ…çš„å†™æ³•</title><link>https://guzhongren.github.io/2020/04/rust%E4%B8%AD%E9%97%AD%E5%8C%85%E7%9A%84%E5%86%99%E6%B3%95.zh/</link><pubDate>Tue, 07 Apr 2020 22:26:14 +0800</pubDate><author>è°·ä¸­ä»</author><guid>https://guzhongren.github.io/2020/04/rust%E4%B8%AD%E9%97%AD%E5%8C%85%E7%9A%84%E5%86%99%E6%B3%95.zh/</guid><description><![CDATA[<div class="featured-image">
                <img src="https://images.pexels.com/photos/3609267/pexels-photo-3609267.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=1&amp;w=500" referrerpolicy="no-referrer">
            </div><p>åœ¨é²è¿…çš„æ–‡ç« ã€Šå­”ä¹™å·±ã€‹ä¸­è¯´ï¼ŒèŒ´é¦™è±†çš„èŒ´å­—æœ‰å¥½å‡ ç§å†™æ³•ï¼Œè®°å¾—æ²¡é”™çš„è¯åº”è¯¥æ˜¯å››ç§ï¼Œå…·ä½“å“ªå››ç§è¯·å‚è€ƒä¸‹æ–‡å¼•ç”¨ã€‚</p>
<p>åœ¨ Rust ä¸­ï¼Œé—­åŒ…ä¹Ÿæœ‰å¥½å‡ ç§å†™æ³•ï¼Œä»Šå¤©å°±æ¥æ€»ç»“ä¸€å“ˆã€‚</p>
<h2 id="é—­åŒ…çš„å†™æ³•">é—­åŒ…çš„å†™æ³•</h2>
<h3 id="é—­åŒ…è¯­æ³•">é—­åŒ…è¯­æ³•</h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-rust">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="w"> </span><span class="k">fn</span> <span class="nf">add_one_v1</span><span class="p">(</span><span class="n">x</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u32</span> <span class="p">{</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">add_one_v2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">x</span>: <span class="kt">u32</span><span class="o">|</span><span class="w"> </span>-&gt; <span class="kt">u32</span> <span class="p">{</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">add_one_v3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">add_one_v4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span></span></span></code></pre></div></div>
<h3 id="ä½¿ç”¨é—­åŒ…">ä½¿ç”¨é—­åŒ…</h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-rust">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_one_v1</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_one_v2</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_one_v3</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add_one_v4</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">&#34;a=</span><span class="si">{}</span><span class="s">, b=</span><span class="si">{}</span><span class="s">, c=</span><span class="si">{}</span><span class="s">, d=</span><span class="si">{}</span><span class="s">&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">);</span></span></span></code></pre></div></div>
<p>æ‰§è¡Œ<code>cargo run</code>ä¼šå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p>
<p><code>a=6, b=6, c=6, d=6</code></p>
<h2 id="é‡ç‚¹è¯´æ˜">é‡ç‚¹è¯´æ˜</h2>
<blockquote>
<p>é—­åŒ…å®šä¹‰ä¼šä¸ºæ¯ä¸ªå‚æ•°å’Œè¿”å›å€¼ç±»å‹æ¨å¯¼ä¸€ä¸ªå…·ä½“çš„ç±»å‹ï¼Œä½†æ˜¯ä¸èƒ½æ¨å¯¼ä¸¤æ¬¡ï¼ˆä¸èƒ½è®©ä¿©æ¬¡æˆ–å¤šæ¬¡ä½¿ç”¨æ˜¯ä¸åŒç±»å‹çš„å‚æ•°è¿›è¡Œè°ƒç”¨ï¼‰</p>
</blockquote>
<p>è¯­è¨€æè¿°æœ‰ç‚¹æ¨¡ç³Šï¼Œé‚£ä¹ˆç”¨ä»£ç è¯´æ˜é—®é¢˜</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-rust">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="w"> </span><span class="c1">// ä¸èƒ½æ¨å¯¼ä¸¤æ¬¡çš„ç¤ºä¾‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">example_closure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">example_closure</span><span class="p">(</span><span class="nb">String</span>::<span class="n">from</span><span class="p">(</span><span class="s">&#34;hello&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">&#34;ç¬¬ä¸€æ¬¡</span><span class="si">{}</span><span class="s">&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="c1">// å¦‚æœå‚æ•°ä¸ºæ•°å­— 5 ï¼Œåˆ™æŠ¥é”™
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w"> </span><span class="c1">// let n = example_closure(5);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">example_closure</span><span class="p">(</span><span class="mf">5.</span><span class="n">to_string</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="fm">println!</span><span class="p">(</span><span class="s">&#34;ç¬¬äºŒæ¬¡</span><span class="si">{}</span><span class="s">&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span></span></span></code></pre></div></div>
<p>åœ¨ä¸Šé¢æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå‚æ•°ä¸º x, è¿”å›å€¼ä¸º x çš„é—­åŒ…ï¼Œä½†æ˜¯ x çš„ç±»å‹æˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®šã€‚</p>
<p>ç»è¿‡ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¼ å…¥å‚æ•°ç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œ å¾—åˆ°çš„ç»“æœ s ä¹Ÿä¸ºå­—ç¬¦ä¸² <code>hello</code>,</p>
<p>ç¬¬äºŒæ¬¡è°ƒç”¨å¦‚æœä¼ å…¥å‚æ•°ä¸ºæ•°å­— 5ï¼Œ é‚£ä¹ˆç¨‹åºå°±ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-shell">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">error<span class="o">[</span>E0308<span class="o">]</span>: mismatched types
</span></span><span class="line"><span class="cl">  --&gt; src/main.rs:22:29
</span></span><span class="line"><span class="cl">   <span class="p">|</span>
</span></span><span class="line"><span class="cl"><span class="m">22</span> <span class="p">|</span>     <span class="nb">let</span> <span class="nv">n</span> <span class="o">=</span> example_closure<span class="o">(</span>5<span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="p">|</span>                             ^
</span></span><span class="line"><span class="cl">   <span class="p">|</span>                             <span class="p">|</span>
</span></span><span class="line"><span class="cl">   <span class="p">|</span>                             expected struct <span class="sb">`</span>std::string::String<span class="sb">`</span>, found integer
</span></span><span class="line"><span class="cl">   <span class="p">|</span>                             help: try using a conversion method: <span class="sb">`</span>5.to_string<span class="o">()</span><span class="sb">`</span></span></span></code></pre></div></div>
<p>å¦‚æœå°†æ•°å­— 5 è½¬æ¢ä¸ºå­—ç¬¦ä¸² 5ï¼Œé‚£ä¹ˆç¨‹åºå°±è¿è¡Œæ­£å¸¸ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>Rust çš„é—­åŒ…æ„Ÿè§‰å’Œ js çš„å‡½æ•°çš„å†™æ³•å¾ˆåƒï¼Œæ„Ÿè§‰åˆ°äº† Rust åˆå€Ÿé‰´äº†éƒ¨åˆ† js çš„è¯­æ³•ã€‚</p>
<h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<ul>
<li><a href="https://guzhongren.github.io/" target="_blank" rel="noopener noreffer ">1. åšå®¢ï¼šhttps://guzhongren.github.io/</a></li>
<li><a href="https://sm.ms/" target="_blank" rel="noopener noreffer ">2. å›¾åºŠï¼šhttps://sm.ms/</a></li>
<li><a href="https://zhidao.baidu.com/question/1448503662321920660.html" target="_blank" rel="noopener noreffer ">3. èŒ´é¦™è±†çš„èŒ´å­—çš„å†™æ³•ï¼šhttps://zhidao.baidu.com/question/1448503662321920660.html</a></li>
<li><a href="https://doc.rust-lang.org/rust-by-example/fn/closures.html" target="_blank" rel="noopener noreffer ">4.Rust é—­åŒ…ï¼šhttps://doc.rust-lang.org/rust-by-example/fn/closures.html</a></li>
</ul>
<h2 id="å…è´£å£°æ˜">å…è´£å£°æ˜</h2>
<p>æœ¬æ–‡ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œä¸æœ¬äººæ‰€ä¾›èŒçš„å…¬å¸æ— ä»»ä½•å…³ç³»ã€‚</p>
<hr>
<p></p>
]]></description></item><item><title>[ç¿»è¯‘]Hello,wasm Pack Cargo.toml</title><link>https://guzhongren.github.io/2019/11/%E7%BF%BB%E8%AF%91hellowasm-pack-cargo.toml.zh/</link><pubDate>Wed, 27 Nov 2019 23:23:36 +0800</pubDate><author>è°·ä¸­ä»</author><guid>https://guzhongren.github.io/2019/11/%E7%BF%BB%E8%AF%91hellowasm-pack-cargo.toml.zh/</guid><description><![CDATA[<p></p>
<h2 id="cargotoml">Cargo.toml</h2>
<p><code>cargo.toml</code>æ˜¯ Rust åŒ…ç®¡ç†å™¨ <code>cargo</code> çš„æ¸…å•æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶åŒ… <code>name</code>ã€ <code>version</code> å’ŒåŒ…çš„ä¾èµ–ï¼Œåœ¨ Rust ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸º <code>crate</code>ã€‚</p>
<p>åœ¨ç¤ºä¾‹ä¸­ç»™å‡ºäº†ä¸€ç³»åˆ—ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸»è¦è®¨è®ºå¦‚ä¸‹ä¸‰ç‚¹ï¼š</p>
<ul>
<li><code>crate-type</code></li>
<li><code>wasm-bindgen</code> ä¾èµ–</li>
<li><code>[features]</code> å’Œ <code>wee_alloc</code>ã€<code>console_error_panic_hook</code> ä¾èµ–</li>
</ul>
<h3 id="1crate-type">1.<code>crate-type</code></h3>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-toml">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[</span><span class="nx">lib</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">crate-type</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;cdylib&#34;</span><span class="p">,</span> <span class="s2">&#34;rlib&#34;</span><span class="p">]</span></span></span></code></pre></div></div>
<p><code>Rust-wasm</code> åŒ…ä¸é€šå¸¸çš„ <code>crate</code> æœ‰ä¸€ç‚¹ä¸åŒï¼Œä½œä¸º WebAssembly é¡¹ç›®ï¼Œ æˆ‘ä»¬éœ€è¦åœ¨ <code>cargo.toml</code> ä¸­åŠ å…¥è¯¥è¯´æ˜ã€‚</p>
<p>å¦‚æœä½ ç†Ÿæ‚‰å…¶ä»–çš„ Rust crateï¼Œé‚£ä¹ˆä½ è‚¯å®šçŸ¥é“ï¼Œå¤§å¤šçš„ crate çš„ç±»å‹æ˜¯ <code>rlib</code>ï¼ˆé»˜è®¤ï¼‰ï¼Œ æˆ–è€…æ˜¯äºŒè¿›åˆ¶å½¢å¼çš„ <code>bin</code>ï¼ˆè¿™ç§å½¢å¼ä¸éœ€è¦ <code>crate-type</code> æ³¨è§£ï¼‰, å¹¶ä¸” <code>[lib]</code> æ³¨è§£åœ¨æ™®é€šçš„ <code>Cargo</code> é¡¹ç›®ä¸­å¹¶ä¸éœ€è¦æŒ‡å®šã€‚</p>
<p>crate-type = [&ldquo;cdylib&rdquo;] æŒ‡ç¤ºä½ çš„å·¥ç¨‹å°†ä¼šè¢«ç¼–è¯‘ä¸ºåŠ¨æ€ç³»ç»Ÿåº“ [dynamic system library], ä½†æ˜¯å¯¹äº WebAssemblyï¼Œä»–å°†ä¼šç¼–è¯‘ä¸ºä¸€ä¸ªæ²¡æœ‰å¯åŠ¨å‡½æ•°çš„ .wasm æ–‡ä»¶ï¼Œåœ¨ Linux å¹³å°ä¸Šï¼Œä»–å°†ä¼šåˆ›å»º*.so æ–‡ä»¶ï¼Œåœ¨ macOS ä¸Šå°†ä¼šåˆ›å»º*.dylib æ–‡ä»¶ï¼Œåœ¨ windows å¹³å°ä¸Šå°†ä¼šåˆ›å»º *.dylib æ–‡ä»¶ã€‚</p>
<p>æˆ‘ä»¬é€šå¸¸æŒ‡å®š <code>crate-type = [&quot;rlib&quot;]</code> æ¥ç¡®ä¿æˆ‘ä»¬çš„åº“å¯ä»¥ç”¨ wasm-pack æ¥åšå•å…ƒæµ‹è¯•ï¼ˆç¨åä¼šçœ‹åˆ°ï¼‰ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªé…ç½®ï¼Œæˆ‘ä»¬å°†ä¸èƒ½æµ‹è¯•æˆ‘ä»¬çš„åº“ï¼Œå› ä¸º cdylib åŒ…ç±»å‹å’Œ wasm-pack çš„å•å…ƒæµ‹è¯•ç±»å‹ç›¸å†²çªã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨æ­¤ <a href="https://doc.rust-lang.org/reference/linkage.html" target="_blank" rel="noopener noreffer ">é“¾æ¥</a> è·å–æ›´å¤šå…³äºåŒ…ç±»å‹çš„çŸ¥è¯†ã€‚</p>
<h3 id="2-wasm-bindgen-ä¾èµ–">2. wasm-bindgen ä¾èµ–</h3>
<p>wasm-bindgen åœ¨ WebAssembly ä¸­æ˜¯ä¸€ä¸ªé‡è¦çš„ä¾èµ–ã€‚ è¿™ä¸ªåŒ…å…è®¸æˆ‘ä»¬ä½¿ç”¨ <code>[wasm-bindgen]</code> ä¸ºåœ¨ JavaScript å’Œ Rust ç”Ÿæˆçš„ wasm ä¹‹é—´çš„ä»£ç æ‰“æ ‡ç­¾ã€‚ä»¥ä½¿æˆ‘ä»¬ä½¿ç”¨å®ƒçš„å±æ€§å¯ä»¥å¯¼å…¥ JS å¹¶ä¸”å¯¼å‡º Rustã€‚</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-toml">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="nx">wasm-bindgen</span> <span class="p">=</span> <span class="s2">&#34;0.2&#34;</span></span></span></code></pre></div></div>
<p>å½“æˆ‘ä»¬è®¨è®º lib.rs ç”Ÿæˆä»€ä¹ˆå†…å®¹çš„æ—¶å€™ï¼Œå°†ä¼šçœ‹åˆ°æ›´å¤šå…³äºæ€ä¹ˆä½¿ç”¨è¿™ä¸ªåº“ã€‚
å¦‚æœä½ ä» JavaScript æŠ€æœ¯æ ˆè¿‡æ¥ï¼Œä½ å¯èƒ½æ³¨æ„åˆ°äº†å½“æˆ‘ä»¬æ·»åŠ ä¾èµ–çš„æ—¶å€™å¹¶æ²¡æœ‰åŠ  <code>^</code> æˆ–è€… <code>~</code> , çœ‹èµ·æ¥åƒæ˜¯æˆ‘ä»¬åªè¦ <code>0.2</code> è¿™ä¸ªç‰ˆæœ¬ã€‚ç„¶è€Œï¼Œäº‹å®å¹¶éå¦‚æ­¤ï¼åœ¨ Rust é‡Œï¼Œ <code>^</code> æ˜¯é»˜è®¤çš„ï¼Œä½ å¯ä½¿ç”¨è¿™ä¸ª <a href="https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html" target="_blank" rel="noopener noreffer ">é“¾æ¥</a> æŸ¥çœ‹æ›´å¤šä¿¡æ¯</p>
<h3 id="3-features-å’Œ-wee_alloc-console_error_panic_hook-dependencies">3. [features] å’Œ wee_alloc, console_error_panic_hook dependencies</h3>
<p>ä½œä¸ºæˆ‘ä»¬è®¾è®¡æ¨¡æ¿çš„å·¥ä½œçš„ä¸€éƒ¨åˆ†ï¼Œè¯¥æ¨¡æ¿å¯å¸®åŠ©äººä»¬å‘ç°é’ˆå¯¹ç‰¹å®šç”¨ä¾‹çš„æœ‰ç”¨åŒ…ï¼Œè¯¥æ¨¡æ¿åŒ…æ‹¬ä¸¤ä¸ªä¾èµ–é¡¹ï¼Œè¿™å¯¹äºå¼€å‘ Rust-wasm åŒ…çš„äººä»¬å¯èƒ½éå¸¸æœ‰ç”¨ï¼šconsole_error_panic_hook å’Œ wee_allocã€‚</p>
<p>å› ä¸ºè¿™äº›ä¾èµ–å…³ç³»ä¸»è¦åœ¨ Rust-wasm åŒ…å¼€å‘å·¥ä½œæµç¨‹çš„ç‰¹å®šéƒ¨åˆ†ä¸­æœ‰ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è®¾ç½®äº†ä¸€äº›ç²˜åˆä»£ç ï¼Œä½¿æˆ‘ä»¬æ—¢å¯ä»¥å°†å®ƒä»¬éƒ½åŒ…å«ä¸ºä¾èµ–å…³ç³»ï¼Œåˆå¯ä»¥é€‰æ‹©å°†å®ƒä»¬åŒ…å«åœ¨å†…ã€‚</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-toml">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[</span><span class="nx">features</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">default</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;console_error_panic_hook&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">dependencies</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">wasm-bindgen</span> <span class="p">=</span> <span class="s2">&#34;0.2&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># The `console_error_panic_hook` crate provides better debugging of panics by</span>
</span></span><span class="line"><span class="cl"><span class="c"># logging them with `console.error`. This is great for development, but requires</span>
</span></span><span class="line"><span class="cl"><span class="c"># all the `std::fmt` and `std::panicking` infrastructure, so isn&#39;t great for</span>
</span></span><span class="line"><span class="cl"><span class="c"># code size when deploying.</span>
</span></span><span class="line"><span class="cl"><span class="nx">console_error_panic_hook</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">version</span> <span class="p">=</span> <span class="s2">&#34;0.1.1&#34;</span><span class="p">,</span> <span class="nx">optional</span> <span class="p">=</span> <span class="kc">true</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># `wee_alloc` is a tiny allocator for wasm that is only ~1K in code size</span>
</span></span><span class="line"><span class="cl"><span class="c"># compared to the default allocator&#39;s ~10K. It is slower than the default</span>
</span></span><span class="line"><span class="cl"><span class="c"># allocator, however.</span>
</span></span><span class="line"><span class="cl"><span class="c">#</span>
</span></span><span class="line"><span class="cl"><span class="c"># Unfortunately, `wee_alloc` requires nightly Rust when targeting wasm for now.</span>
</span></span><span class="line"><span class="cl"><span class="nx">wee_alloc</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">version</span> <span class="p">=</span> <span class="s2">&#34;0.4.2&#34;</span><span class="p">,</span> <span class="nx">optional</span> <span class="p">=</span> <span class="kc">true</span> <span class="p">}</span></span></span></code></pre></div></div>
<p>åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œåªæœ‰åœ¨å¯ç”¨æŸäº› [features] çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ‰ä¼šå°†ä»£ç çš„æŸäº›éƒ¨åˆ†æ ‡è®°ä¸ºæ­£åœ¨è¿è¡Œï¼Œç‰¹åˆ«æ˜¯ console_error_panic_hook å’Œ wee_allocã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä»…å¯ç”¨ console_error_panic_hookã€‚è¦ç¦ç”¨æˆ–å¯ç”¨ä»»ä¸€åŠŸèƒ½ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ [features] ä¸‹ç¼–è¾‘ default æ•°ç»„ã€‚</p>
<p>è¦äº†è§£æœ‰å…³è¿™äº›åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œæˆ‘ä»¬å°†åœ¨ src/lib.rs å’Œ src/utils.rs éƒ¨åˆ†ä¸­æ·±å…¥è®¨è®ºå®ƒä»¬ã€‚
ç®€è¦åœ°ï¼Œå®ƒä»¬åŒ…æ‹¬ï¼š</p>
<ul>
<li>console_error_panic_hook ï¼Œç”¨äºå°†å¥”æºƒæ¶ˆæ¯è®°å½•åˆ°å¼€å‘äººå‘˜æ§åˆ¶å°çš„åŠŸèƒ½ã€‚</li>
<li>wee_allocï¼Œä¸€ä¸ªä½¿ä»£ç é‡æ›´å°è€Œä¼˜åŒ–çš„åˆ†é…å™¨ã€‚</li>
</ul>
<h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<p><a href="https://guzhongren.github.io/" target="_blank" rel="noopener noreffer ">1.https://guzhongren.github.io/</a></p>
<hr>
<p></p>
]]></description></item><item><title>åŸºäº Rust çš„ WebAssembly å·¥ç¨‹å¼€å‘è¿‡ç¨‹å°è®°</title><link>https://guzhongren.github.io/2019/11/%E5%9F%BA%E4%BA%8Erust%E7%9A%84webassembly%E5%B7%A5%E7%A8%8B%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B%E5%B0%8F%E8%AE%B0/</link><pubDate>Sat, 23 Nov 2019 22:43:42 +0800</pubDate><author>è°·ä¸­ä»</author><guid>https://guzhongren.github.io/2019/11/%E5%9F%BA%E4%BA%8Erust%E7%9A%84webassembly%E5%B7%A5%E7%A8%8B%E5%BC%80%E5%8F%91%E8%BF%87%E7%A8%8B%E5%B0%8F%E8%AE%B0/</guid><description><![CDATA[<div class="featured-image">
                <img src="https://i.loli.net/2020/06/27/PabvnjXR1MouQcz.png" referrerpolicy="no-referrer">
            </div><h2 id="åˆå§‹åŒ–å·¥ç¨‹">åˆå§‹åŒ–å·¥ç¨‹</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>$ npm init rust-webpack web_assembly_demo
npx: 18 å®‰è£…æˆåŠŸï¼Œç”¨æ—¶ 3.989 ç§’
 Rust +  WebAssembly + Webpack = ï¸
Installed dependencies</code></pre></div>
<h2 id="å®‰è£…-web-ä¾èµ–">å®‰è£… Web ä¾èµ–</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>$ yarn
yarn install v1.19.1
warning package.json: No license field
info No lockfile found.
warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
warning rust-webpack-template@0.1.0: No license field
[1/4]   Resolving packages...
warning @wasm-tool/wasm-pack-plugin &gt; watchpack &gt; chokidar &gt; fsevents@1.2.9: One of your dependencies needs to upgrade to fsevents v2: 1) Proper nodejs v10+ support 2) No more fetching binaries from AWS, smaller package size
[2/4]   Fetching packages...
[3/4]   Linking dependencies...
[4/4]   Building fresh packages...
success Saved lockfile.
  Done in 17.87s.</code></pre></div>
<h2 id="ä¿®æ”¹-cargotoml-ä¸º">ä¿®æ”¹ Cargo.toml ä¸º</h2>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-toml">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="c"># You must change these to your own details.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">package</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">name</span> <span class="p">=</span> <span class="s2">&#34;web_assembly_demo&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">description</span> <span class="p">=</span> <span class="s2">&#34;My super awesome Rust, WebAssembly, and Webpack project!&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">version</span> <span class="p">=</span> <span class="s2">&#34;0.1.0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">authors</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;guzhongren &lt;guzhoongren@live.cn&gt;&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">categories</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;wasm&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">readme</span> <span class="p">=</span> <span class="s2">&#34;README.md&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">edition</span> <span class="p">=</span> <span class="s2">&#34;2018&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">lib</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">crate-type</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;cdylib&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">profile</span><span class="p">.</span><span class="nx">release</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c"># This makes the compiled code faster and smaller, but it makes compiling slower,</span>
</span></span><span class="line"><span class="cl"><span class="c"># so it&#39;s only enabled in release mode.</span>
</span></span><span class="line"><span class="cl"><span class="nx">lto</span> <span class="p">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">features</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c"># If you uncomment this line, it will enable `wee_alloc`:</span>
</span></span><span class="line"><span class="cl"><span class="c">#default = [&#34;wee_alloc&#34;]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">dependencies</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="c"># The `wasm-bindgen` crate provides the bare minimum functionality needed</span>
</span></span><span class="line"><span class="cl"><span class="c"># to interact with JavaScript.</span>
</span></span><span class="line"><span class="cl"><span class="nx">wasm-bindgen</span> <span class="p">=</span> <span class="s2">&#34;0.2.45&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># `wee_alloc` is a tiny allocator for wasm that is only ~1K in code size</span>
</span></span><span class="line"><span class="cl"><span class="c"># compared to the default allocator&#39;s ~10K. However, it is slower than the default</span>
</span></span><span class="line"><span class="cl"><span class="c"># allocator, so it&#39;s not enabled by default.</span>
</span></span><span class="line"><span class="cl"><span class="nx">wee_alloc</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">version</span> <span class="p">=</span> <span class="s2">&#34;0.4.2&#34;</span><span class="p">,</span> <span class="nx">optional</span> <span class="p">=</span> <span class="kc">true</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># The `web-sys` crate allows you to interact with the various browser APIs,</span>
</span></span><span class="line"><span class="cl"><span class="c"># like the DOM.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">dependencies</span><span class="p">.</span><span class="nx">web-sys</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">version</span> <span class="p">=</span> <span class="s2">&#34;0.3.22&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">features</span> <span class="p">=</span> <span class="p">[</span><span class="s2">&#34;console&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># The `console_error_panic_hook` crate provides better debugging of panics by</span>
</span></span><span class="line"><span class="cl"><span class="c"># logging them with `console.error`. This is great for development, but requires</span>
</span></span><span class="line"><span class="cl"><span class="c"># all the `std::fmt` and `std::panicking` infrastructure, so it&#39;s only enabled</span>
</span></span><span class="line"><span class="cl"><span class="c"># in debug mode.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">target</span><span class="p">.</span><span class="s2">&#34;cfg(debug_assertions)&#34;</span><span class="p">.</span><span class="nx">dependencies</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">console_error_panic_hook</span> <span class="p">=</span> <span class="s2">&#34;0.1.5&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c"># These crates are used for running unit tests.</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">dev-dependencies</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">wasm-bindgen-test</span> <span class="p">=</span> <span class="s2">&#34;0.2.45&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">futures</span> <span class="p">=</span> <span class="s2">&#34;0.1.27&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">js-sys</span> <span class="p">=</span> <span class="s2">&#34;0.3.22&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">wasm-bindgen-futures</span> <span class="p">=</span> <span class="s2">&#34;0.3.22&#34;</span></span></span></code></pre></div></div>
<p>Rust çš„ä¾èµ–ä¼šåœ¨å¯åŠ¨ Web ç¨‹åºçš„æ—¶å€™è‡ªåŠ¨å®‰è£…ã€‚</p>
<h2 id="å¯åŠ¨ç¨‹åº">å¯åŠ¨ç¨‹åº</h2>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><pre tabindex="0"><code>$ yarn start
yarn run v1.19.1
warning package.json: No license field
$ rimraf dist pkg &amp;&amp; webpack-dev-server --open -d
ğŸ§  Checking for wasm-pack...

  wasm-pack is installed.

â„¹ï¸  Compiling your crate in development mode...

â„¹ ï½¢wdsï½£: Project is running at http://localhost:8080/
â„¹ ï½¢wdsï½£: webpack output is served from /
â„¹ ï½¢wdsï½£: Content not from webpack is served from /Users/c4/Desktop/Personal/01.Project/web_assembly/web_assembly_demo/dist
[INFO]:   Checking for the Wasm target...
[INFO]:   Compiling to Wasm...
â„¹ ï½¢wdmï½£: wait until bundle finished: /
   Compiling proc-macro2 v1.0.6
   Compiling unicode-xid v0.2.0
...
 3 assets
Entrypoint index = index.js
[./pkg/index.js] 4.41 KiB {0} [built]
[./pkg/index_bg.wasm] 145 KiB {0} [built]
    + 33 hidden modules
â„¹ ï½¢wdmï½£: Compiled successfully.
â„¹ï¸  Compiling your crate in development mode...

[INFO]:   Checking for the Wasm target...
[INFO]:   Compiling to Wasm...
   Compiling rust-webpack-template v0.1.0 (/Users/c4/Desktop/Personal/01.Project/web_assembly/web_assembly_demo)
    Finished dev [unoptimized + debuginfo] target(s) in 0.62s
[INFO]: â¬‡ï¸  Installing wasm-bindgen...
[INFO]: Optional fields missing from Cargo.toml: &#39;repository&#39;, &#39;license&#39;. These are not necessary, but recommended
[INFO]:    Done in 0.77s
[INFO]:    Your wasm pkg is ready to publish at ./pkg.
  Your crate has been correctly compiled

â„¹ ï½¢wdmï½£: Compiling...
â„¹ ï½¢wdmï½£: Hash: d4e8a3c57ad23f847707
Version: webpack 4.41.2
Time: 411ms
Built at: 2019-11-23 20:16:55
                           Asset     Size  Chunks                         Chunk Names
                            0.js   17 KiB       0  [emitted]
beee557fb69dcfa0df60.module.wasm  161 KiB       0  [emitted] [immutable]
                        index.js  897 KiB   index  [emitted]              index
Entrypoint index = index.js
[./pkg/index.js] 4.93 KiB {0} [built]
[./pkg/index_bg.wasm] 161 KiB {0} [built]
    + 33 hidden modules
â„¹ ï½¢wdmï½£: Compiled successfully.
â„¹ ï½¢wdmï½£: Compiling...
â„¹ ï½¢wdmï½£: Hash: 3e1681b9b4c4c940722e
Version: webpack 4.41.2
Time: 16ms
Built at: 2019-11-23 20:17:14
   Asset     Size  Chunks             Chunk Names
index.js  897 KiB   index  [emitted]  index
 + 2 hidden assets</code></pre></div>
<h2 id="åœ¨-src-ä¸­æ–°å»º-parsers-å¹¶ç¼–å†™å¤„ç†-markdown-çš„-rust-ä»£ç ">åœ¨ src ä¸­æ–°å»º parse.rs å¹¶ç¼–å†™å¤„ç† markdown çš„ rust ä»£ç </h2>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-rust">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="k">struct</span> <span class="nc">Parser</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">pos</span>: <span class="kt">usize</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">input</span>: <span class="nb">String</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">parse</span><span class="p">(</span><span class="n">source</span>: <span class="nb">String</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">Parser</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">pos</span>: <span class="mi">0</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">input</span>: <span class="nc">source</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}.</span><span class="n">parse_lines</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">impl</span><span class="w"> </span><span class="n">Parser</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">parse_lines</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span>::<span class="n">new</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">loop</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="bp">self</span><span class="p">.</span><span class="n">consume_whitespace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">end_of_line</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">result</span><span class="p">.</span><span class="n">push_str</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">parse_line</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">result</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">parse_line</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">match</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">next_char</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="sc">&#39;#&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">parse_title</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="sc">&#39;-&#39;</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="kt">char</span>::<span class="n">is_whitespace</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">..</span><span class="p">].</span><span class="n">chars</span><span class="p">().</span><span class="n">next</span><span class="p">().</span><span class="n">unwrap</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="bp">self</span><span class="p">.</span><span class="n">parse_list</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="bp">self</span><span class="p">.</span><span class="n">parse_text</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">parse_text</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">parse_list</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">consume_char</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">consume_whitespace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">parse_text</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">create_html_element</span><span class="p">(</span><span class="s">&#34;li&#34;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">parse_title</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">pound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">consume_while</span><span class="p">(</span><span class="o">|</span><span class="n">c</span><span class="o">|</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;#&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">consume_whitespace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">parse_text</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">create_html_element</span><span class="p">(</span><span class="fm">format!</span><span class="p">(</span><span class="s">&#34;h</span><span class="si">{}</span><span class="s">&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">pound</span><span class="p">.</span><span class="n">len</span><span class="p">()),</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">parse_text</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">consume_while</span><span class="p">(</span><span class="o">|</span><span class="n">c</span><span class="o">|</span><span class="w"> </span><span class="o">!</span><span class="n">is_new_line</span><span class="p">(</span><span class="n">c</span><span class="p">))</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">end_of_line</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">input</span><span class="p">.</span><span class="n">len</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">// fn starts_with(&amp;self, s: &amp;str) -&gt; bool {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">//   self.input[self.pos..].starts_with(s)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">// }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">next_char</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">char</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">pos</span><span class="o">..</span><span class="p">].</span><span class="n">chars</span><span class="p">().</span><span class="n">next</span><span class="p">().</span><span class="n">unwrap</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">consume_char</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">char</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">input</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">pos</span><span class="o">..</span><span class="p">].</span><span class="n">char_indices</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">cur_char</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iter</span><span class="p">.</span><span class="n">next</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">next_pos</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iter</span><span class="p">.</span><span class="n">next</span><span class="p">().</span><span class="n">unwrap_or</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39; &#39;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">pos</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">next_pos</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">cur_char</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">consume_while</span><span class="o">&lt;</span><span class="n">F</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">cond</span>: <span class="nc">F</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span>
</span></span><span class="line"><span class="cl">  <span class="nc">where</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">F</span>: <span class="nb">Fn</span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span>::<span class="n">new</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="o">!</span><span class="bp">self</span><span class="p">.</span><span class="n">end_of_line</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cond</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">next_char</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">result</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">consume_char</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">result</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">fn</span> <span class="nf">consume_whitespace</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="bp">self</span><span class="p">.</span><span class="n">consume_while</span><span class="p">(</span><span class="kt">char</span>::<span class="n">is_whitespace</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">create_html_element</span><span class="p">(</span><span class="n">tag_name</span>: <span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">text</span>: <span class="nb">String</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="fm">format!</span><span class="p">(</span><span class="s">&#34;&lt;</span><span class="si">{}</span><span class="s">&gt;</span><span class="si">{}</span><span class="s">&lt;/</span><span class="si">{}</span><span class="s">&gt;&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">tag_name</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="p">,</span><span class="w"> </span><span class="n">tag_name</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">fn</span> <span class="nf">is_new_line</span><span class="p">(</span><span class="n">c</span>: <span class="kt">char</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">bool</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">c</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></div></div>
<h2 id="åœ¨-srclibrs-ä¸­å¼•å…¥-parse-mod-å¹¶ç¼–å†™å‘å¤–æš´éœ²çš„å‡½æ•°">åœ¨ src/lib.rs ä¸­å¼•å…¥ parse modï¼Œ å¹¶ç¼–å†™å‘å¤–æš´éœ²çš„å‡½æ•°</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-Rust">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Rust" data-lang="Rust"><span class="line"><span class="cl"><span class="k">mod</span> <span class="nn">parser</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">extern</span><span class="w"> </span><span class="k">crate</span><span class="w"> </span><span class="n">wasm_bindgen</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">use</span><span class="w"> </span><span class="n">wasm_bindgen</span>::<span class="n">prelude</span>::<span class="o">*</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cp">#[wasm_bindgen]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span> <span class="nf">parse</span><span class="p">(</span><span class="n">input</span>: <span class="kp">&amp;</span><span class="kt">str</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="nb">String</span> <span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parser</span>::<span class="n">parse</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="n">to_string</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">result</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span></span></span></code></pre></div></div>
<h2 id="åœ¨-jsindexjs-ä¸­ä½¿ç”¨-web-assembly-ä¿®æ”¹ç»“æœå¦‚ä¸‹">åœ¨ js/index.js ä¸­ä½¿ç”¨ Web Assembly ï¼Œä¿®æ”¹ç»“æœå¦‚ä¸‹</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-rust">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-rust" data-lang="rust"><span class="line"><span class="cl"><span class="n">document</span><span class="p">.</span><span class="n">body</span><span class="p">.</span><span class="n">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addElement</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">function</span><span class="w"> </span><span class="n">addElement</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">markdown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">createElement</span><span class="p">(</span><span class="na">&#39;textarea&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">markdown</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="na">&#39;markdown&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">markdown</span><span class="p">.</span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;height: 300px; width: 400px ;&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">document</span><span class="p">.</span><span class="n">body</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">markdown</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">parseBtn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">createElement</span><span class="p">(</span><span class="na">&#39;button&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">parseBtn</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="na">&#39;parse&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">parseBtn</span><span class="p">.</span><span class="n">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="na">&#39;</span><span class="err">è§£æ</span><span class="w"> </span><span class="n">markdown</span><span class="na">&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">document</span><span class="p">.</span><span class="n">body</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">parseBtn</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">previewArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">createElement</span><span class="p">(</span><span class="na">&#39;div&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">previewArea</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="na">&#39;preview&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">document</span><span class="p">.</span><span class="n">body</span><span class="p">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">previewArea</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">rust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">import</span><span class="p">(</span><span class="na">&#39;</span><span class="o">../</span><span class="n">pkg</span><span class="o">/</span><span class="n">index</span><span class="p">.</span><span class="n">js</span><span class="na">&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">rust</span><span class="p">.</span><span class="n">then</span><span class="p">(</span><span class="n">module</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">btn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">getElementById</span><span class="p">(</span><span class="na">&#39;parse&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">previewArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">getElementById</span><span class="p">(</span><span class="na">&#39;preview&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">btn</span><span class="p">.</span><span class="n">addEventListener</span><span class="p">(</span><span class="na">&#39;click&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">const</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="n">getElementById</span><span class="p">(</span><span class="na">&#39;markdown&#39;</span><span class="p">).</span><span class="n">value</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">previewArea</span><span class="p">.</span><span class="n">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">module</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">})</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">})</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// import(&#34;../pkg/index.js&#34;).then(module =&gt; {
</span></span></span><span class="line"><span class="cl"><span class="c1">//   const input = &#39;1233&#39;
</span></span></span><span class="line"><span class="cl"><span class="c1">//     previewArea.innerHTML = module.parse(input)
</span></span></span><span class="line"><span class="cl"><span class="c1">// }).catch(console.error);
</span></span></span></code></pre></div></div>
<h2 id="æ•ˆæœå›¾">æ•ˆæœå›¾</h2>
<p></p>
<h2 id="åœ¨çº¿ä½“éªŒ">åœ¨çº¿ä½“éªŒ</h2>
<p><a href="https://andorlab.github.io/WebAssembly/" target="_blank" rel="noopener noreffer ">Markdown editor</a>: <a href="https://andorlab.github.io/WebAssembly/" target="_blank" rel="noopener noreffer ">https://andorlab.github.io/WebAssembly/</a></p>
<h2 id="åç»­">åç»­</h2>
<p>åé¢ä¼šåœ¨è¿™ä¸ªåŸºç¡€ä¸Šç»§ç»­å¼€å‘ï¼Œå¹¶å°† WASM ä¸­çš„ä¸€äº›æ¦‚å¿µé…ç½®ä¹Ÿå†™æˆæ–‡æ¡£å…±äº«åœ¨åšå®¢ä¸­ã€‚</p>
<h2 id="ä»“åº“åœ°å€httpsgithubcomandorlabweb_assemblytreebased_rust">ä»“åº“åœ°å€ï¼š<a href="https://github.com/AndorLab/web_assembly/tree/based_rust" target="_blank" rel="noopener noreffer ">https://github.com/AndorLab/web_assembly/tree/based_rust</a></h2>
<h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<ul>
<li><a href="https://guzhongren.github.io/" target="_blank" rel="noopener noreffer ">1. åšå®¢ï¼šhttps://guzhongren.github.io/</a></li>
<li><a href="https://sm.ms/" target="_blank" rel="noopener noreffer ">2. å›¾åºŠï¼šhttps://sm.ms/</a></li>
</ul>
<h2 id="å…è´£å£°æ˜">å…è´£å£°æ˜</h2>
<p>æœ¬æ–‡ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œä¸æœ¬äººæ‰€ä¾›èŒçš„å…¬å¸æ— ä»»ä½•å…³ç³»ã€‚</p>
<hr>
<p></p>
]]></description></item><item><title>åœ¨ VSCode ä¸Šé…ç½® Rust çš„è°ƒè¯•ç¯å¢ƒ</title><link>https://guzhongren.github.io/2019/10/%E5%9C%A8-vscode-%E4%B8%8A%E9%85%8D%E7%BD%AErust%E7%9A%84%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83.zh/</link><pubDate>Thu, 17 Oct 2019 20:50:05 +0800</pubDate><author>è°·ä¸­ä»</author><guid>https://guzhongren.github.io/2019/10/%E5%9C%A8-vscode-%E4%B8%8A%E9%85%8D%E7%BD%AErust%E7%9A%84%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83.zh/</guid><description><![CDATA[<p></p>
<h2 id="æ’ä»¶">æ’ä»¶</h2>
<p>åœ¨ VS Code ä¸Šè¿›è¡Œ Rust çš„å¼€å‘ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸‹ä¸¤ä¸ªåº“</p>
<ul>
<li>RLS(vscode æœç´¢æ’ä»¶ rls)</li>
<li>lldb(vscode æœç´¢æ’ä»¶ codelldb)</li>
</ul>
<p>å®‰è£…å¾ˆç®€å•ï¼Œä¸ç”¨è¯´</p>
<h2 id="é…ç½®">é…ç½®</h2>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-json">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ä½¿ç”¨ IntelliSense äº†è§£ç›¸å…³å±æ€§ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// æ‚¬åœä»¥æŸ¥çœ‹ç°æœ‰å±æ€§çš„æè¿°ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®ï¼šhttps://go.microsoft.com/fwlink/?linkid=830387
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nt">&#34;version&#34;</span><span class="p">:</span> <span class="s2">&#34;0.2.0&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;configurations&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Debug executable &#39;show_posts&#39;&#34;</span><span class="p">,</span> <span class="c1">// é…ç½®åç§°ï¼Œå°†ä¼šåœ¨è°ƒè¯•é…ç½®ä¸‹æ‹‰åˆ—è¡¨ä¸­æ˜¾ç¤º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;type&#34;</span><span class="p">:</span> <span class="s2">&#34;lldb&#34;</span><span class="p">,</span> <span class="c1">// è°ƒè¯•å™¨ç±»å‹ï¼šWindows è¡¨ç¤ºå™¨ä½¿ç”¨ cppvsdbgï¼›GDB å’Œ LLDB ä½¿ç”¨ cppdbgã€‚è¯¥å€¼è‡ªåŠ¨ç”Ÿæˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;request&#34;</span><span class="p">:</span> <span class="s2">&#34;launch&#34;</span><span class="p">,</span> <span class="c1">// è°ƒè¯•æ–¹å¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;cargo&#34;</span><span class="p">:</span> <span class="p">{</span> <span class="c1">// è¿è¡Œçš„å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nt">&#34;args&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;build&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;--bin=show_posts&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="s2">&#34;--package=diesel_demo&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;filter&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;show_posts&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;kind&#34;</span><span class="p">:</span> <span class="s2">&#34;bin&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;args&#34;</span><span class="p">:</span> <span class="p">[],</span> <span class="c1">// ä¼ é€’ç»™ç¨‹åºçš„å‚æ•°ï¼Œæ²¡æœ‰å‚æ•°ç•™ç©ºå³å¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nt">&#34;cwd&#34;</span><span class="p">:</span> <span class="s2">&#34;${workspaceFolder}&#34;</span> <span class="c1">// è°ƒè¯•ç¨‹åºæ—¶çš„å·¥ä½œç›®å½•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span></span></span></code></pre></div></div>
<p></p>
<h2 id="è°ƒè¯•">è°ƒè¯•</h2>
<p></p>
<h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<p><a href="https://guzhongren.github.io/" target="_blank" rel="noopener noreffer ">1.https://guzhongren.github.io/</a></p>
<hr>
<p></p>
]]></description></item></channel></rss>