<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>æµ‹è¯• - æ ‡ç­¾ - è°·ä¸­ä»çš„åšå®¢</title><link>https://guzhongren.github.io/tags/%E6%B5%8B%E8%AF%95/</link><description>æµ‹è¯• - æ ‡ç­¾ - è°·ä¸­ä»çš„åšå®¢</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><copyright>Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Sun, 16 Jan 2022 14:47:53 +0800</lastBuildDate><atom:link href="https://guzhongren.github.io/tags/%E6%B5%8B%E8%AF%95/" rel="self" type="application/rss+xml"/><item><title>ä½¿ç”¨ Cypress åˆ›å»ºæµ‹è¯•é•œåƒå¹¶å®Œæˆ E2E æµ‹è¯•</title><link>https://guzhongren.github.io/2022/01/%E4%BD%BF%E7%94%A8cypress%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E9%95%9C%E5%83%8F%E5%B9%B6%E5%AE%8C%E6%88%90e2e%E6%B5%8B%E8%AF%95/</link><pubDate>Sun, 16 Jan 2022 14:47:53 +0800</pubDate><author>è°·ä¸­ä»</author><guid>https://guzhongren.github.io/2022/01/%E4%BD%BF%E7%94%A8cypress%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E9%95%9C%E5%83%8F%E5%B9%B6%E5%AE%8C%E6%88%90e2e%E6%B5%8B%E8%AF%95/</guid><description><![CDATA[<div class="featured-image">
                <img src="https://images.pexels.com/photos/5667741/pexels-photo-5667741.jpeg?auto=compress&amp;cs=tinysrgb&amp;dpr=2&amp;h=650&amp;w=940" referrerpolicy="no-referrer">
            </div><h2 id="ç¼˜ç”±">ç¼˜ç”±</h2>
<p>æœ€è¿‘åœ¨åšä¸€ä¸ª Buildkite çš„ Dashboard çš„é¡¹ç›® <a href="https://github.com/guzhongren/Powerboard" target="_blank" rel="noopener noreffer ">Powerboard</a>ï¼Œé¡¹ç›®æ˜¯æ‰˜ç®¡åœ¨ GitHub çš„ Git Pages ä¸Šçš„ï¼›é¡¹ç›®åªæ˜¯ä¸€ä¸ªçº¯å‰ç«¯é¡¹ç›®ï¼Œä¸” E2E æµ‹è¯•æ˜¯ç”¨ <a href="https://www.cypress.io/" target="_blank" rel="noopener noreffer ">Cypress</a> æ„å»ºçš„ï¼›å¦‚æœè¦è¿›è¡Œ E2E æµ‹è¯•ä¸€èˆ¬æƒ…å†µéƒ½æ˜¯å¯¹ç€éƒ¨ç½²åœ¨ Git Pages ä¸Šçš„ç½‘ç«™ç›´æ¥æµ‹è¯•ï¼Œè€Œä¸”ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ğŸ˜„ã€‚</p>
<h2 id="ç—›ç‚¹">ç—›ç‚¹</h2>
<h3 id="æµ‹è¯•æ»å">æµ‹è¯•æ»å</h3>
<p>è¿™ä¹ˆåšè‚¯å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œäº§å“éƒ½ä¸Šçº¿äº†æ‰åšæµ‹è¯•ï¼Œè‚¯å®šå·²ç»è¿Ÿäº†ï¼›å¦‚æœç¨‹åºæœ‰é—®é¢˜ï¼Œé‚£ä¹ˆå°±ä¼šå½±å“æ‰€æœ‰ç”¨æˆ·ã€‚è¿™ç§æƒ…å†µåº”è¯¥ç®—æ˜¯ P1 çº§åˆ«çš„äº§å“äº‹æ•…ï¼Œå¯¹ç”¨æˆ·æ¥è¯´ç®€ç›´å°±æ˜¯ç¾éš¾ã€‚åº”è¯¥åœ¨éƒ¨ç½²ä¹‹å‰å°±åº”è¯¥å®Œæˆ E2E æµ‹è¯•ï¼Œå¦‚æœæµ‹è¯•é€šè¿‡ä¸äº†ï¼Œå°±ä¸åº”è¯¥éƒ¨ç½²ä»£ç ã€‚æ‰€ä»¥æµ‹è¯•åº”è¯¥å‰ç§»ã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ</h2>
<p>ç”±äºæˆ‘ä»¬çš„æµ‹è¯•éœ€è¦è‡ªåŠ¨åŒ–ï¼Œéœ€è¦åœ¨ Pipeline ä¸Šæ‰§è¡Œï¼Œæ‰€ä»¥å¿…é¡»æ˜¯ä¸€ä¸ªå¯ä»¥ç‹¬ç«‹è¿è¡Œçš„ç¨‹åºå’Œ Cypress ç¨‹åºåŒæ—¶è¿è¡Œï¼Œå¹¶æœ€ç»ˆè¿”å›æµ‹è¯•ç»“æœï¼Œç”± Pipeline æ¥å†³å®šæ˜¯å¦ç»ˆæ­¢ Pipeline è¿è¡Œã€‚</p>
<p>åœ¨ GitHub Actions çš„ Pipeline ä¸ŠåŒæ—¶è¿è¡Œç¨‹åºåªèƒ½ä¾é  <code>docker-compose</code>, åœ¨è¿™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Cypress å®˜æ–¹å‡ºå“çš„ <a href="https://hub.docker.com/r/cypress/included" target="_blank" rel="noopener noreffer ">cypress/included</a>, é€šè¿‡ç¼–æ’ç¨‹åºæ¥è¿›è¡Œæµ‹è¯•ã€‚</p>
<h3 id="cypressincluded">cypress/included</h3>
<p>cypress/included å¯ä»¥è®©æˆ‘ä»¬æŒ‚è½½ cypress çš„æµ‹è¯•è„šæœ¬ï¼Œç„¶åè‡ªåŠ¨æ‰§è¡Œï¼Œå¹¶åœ¨æœ€ç»ˆè¿”å› Linux å‘½ä»¤çŠ¶æ€å€¼ï¼Œå¦‚ 0 ï¼Œ é 0 å€¼ã€‚</p>
<h3 id="docker-compose">Docker-compose</h3>
<p><a href="https://docs.docker.com/compose/" target="_blank" rel="noopener noreffer ">Docker-compose</a> æ˜¯ä¸€å¥—å®¹å™¨ç¼–æ’å·¥å…·ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„ç®¡ç†å®¹å™¨çš„å¯åŠ¨é¡ºåºç­‰ã€‚åœ¨æœ¬åœ°é¡¹ç›®æ­å»ºä¸­éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚æ„å»ºæ•°æ®åº“ï¼Œæ‰§è¡Œ shell/yaml lint ç­‰ã€‚</p>
<h2 id="æ‰§è¡Œæ–¹æ¡ˆ">æ‰§è¡Œæ–¹æ¡ˆ</h2>
<h3 id="æ„å»ºåº”ç”¨é•œåƒ">æ„å»ºåº”ç”¨é•œåƒ</h3>
<p>åœ¨æµ‹è¯•ä¹‹å‰éœ€è¦å°†åº”ç”¨æ„å»ºå¥½å¹¶éƒ¨ç½²å¥½ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Node é•œåƒæ‰“åŒ…åº”ç”¨ï¼Œå¹¶åˆ©ç”¨å®¹å™¨çš„å¤šé˜¶æ®µæ„å»º (<a href="https://docs.docker.com/develop/develop-images/multistage-build/" target="_blank" rel="noopener noreffer ">multi-stage builds</a>) å®Œæˆåº”ç”¨è½»é‡åŒ–æ„å»ºï¼Œå¹¶éƒ¨ç½²åœ¨ <a href="https://hub.docker.com/_/nginx" target="_blank" rel="noopener noreffer ">Nginx</a> ä¸­ã€‚</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-yaml">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">FROM node:17-alpine as distPackage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">COPY ./ /app</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">WORKDIR /app</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">RUN yarn</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">RUN yarn build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">FROM nginx:latest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">COPY --from=distPackage /app/dist /usr/share/nginx/html</span></span></span></code></pre></div></div>
<h3 id="ç¼–æ’-service">ç¼–æ’ service</h3>
<p>å› ä¸ºæˆ‘ä»¬çš„ç¨‹åºéœ€è¦åœ¨æµ‹è¯•çš„æ—¶å€™å°±è¦éƒ¨ç½²å¥½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ Docker-compose çš„ <a href="https://docs.docker.com/compose/compose-file/compose-file-v3/#build" target="_blank" rel="noopener noreffer ">build</a> å‚æ•°ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶æ„å»ºåº”ç”¨å¹¶éƒ¨ç½²ã€‚å¹¶åœ¨ cypress/included å¯åŠ¨æ˜¯æ‰§è¡Œæµ‹è¯•å‘½ä»¤ <code>npx cy:docker</code>, å…·ä½“å°±æ˜¯<code>cross-env ENV=docker cypress run --spec 'cypress/integration/dashboard.spec.js</code>ã€‚</p>
<div class="code-block code-line-numbers" style="counter-reset: code-block 0">
    <div class="code-header language-yaml">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">web</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">./Dockerfile</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">web</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s1">&#39;80:80&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">e2e</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">cypress/included:9.2.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">cypress</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">web</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">CYPRESS_baseUrl=http://web</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">ENV=docker</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l">npx cy:docker</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">working_dir</span><span class="p">:</span><span class="w"> </span><span class="l">/e2e</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">./:/e2e</span></span></span></code></pre></div></div>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç‹¬ç«‹çš„è¿è¡Œèµ·çœŸå®ç¨‹åºå’Œæ­£å¼çš„æµ‹è¯•ç¨‹åºäº†ï¼Œå…·ä½“çš„ Pipeline å¯ä»¥å‚è€ƒ Powerboard çš„ <a href="https://github.com/guzhongren/Powerboard/blob/main/.github/workflows/main.yml" target="_blank" rel="noopener noreffer ">Workflow</a>ã€‚</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-yml">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="å¤åˆ¶åˆ°å‰ªè´´æ¿"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="w">      </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">E2E</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p">|</span><span class="sd">
</span></span></span><span class="line"><span class="cl"><span class="sd">          docker-compose up --build e2e</span><span class="w">          </span></span></span></code></pre></div></div>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p><code>Docker-compopse</code> æœ‰å¾ˆå¥½çš„åº”ç”¨ç¼–æ’èƒ½åŠ›ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„æ„å»ºå¤šæœåŠ¡ç¨‹åºï¼›å¹¶åœ¨æ„å»ºåº”ç”¨çš„æ—¶å€™å¯ä»¥ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºæ¥ä¼˜åŒ–é•œåƒå¤§å°ã€‚ä½¿ç”¨ <code>Cypress</code> å¯ä»¥æé«˜å¼€å‘æ•ˆç‡å¹¶å¯åœ¨ <code>Pipeline</code> ä¸Šä¿è¯ç¨‹åºçš„æ­£ç¡®æ€§ã€‚</p>
<h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<ul>
<li><a href="https://guzhongren.github.io/" target="_blank" rel="noopener noreffer ">åšå®¢ï¼šhttps://guzhongren.github.io/</a></li>
<li><a href="https://www.cypress.io/" target="_blank" rel="noopener noreffer ">Cypress: https://www.cypress.io/</a></li>
<li><a href="https://hub.docker.com/r/cypress/included" target="_blank" rel="noopener noreffer ">cypress/included: https://hub.docker.com/r/cypress/included</a></li>
<li><a href="https://docs.github.com/en/actions" target="_blank" rel="noopener noreffer ">GitHub Actions: https://docs.github.com/en/actions</a></li>
<li><a href="https://github.com/guzhongren/Powerboard" target="_blank" rel="noopener noreffer ">Powerboard: https://github.com/guzhongren/Powerboard</a></li>
</ul>
<h2 id="å…è´£å£°æ˜">å…è´£å£°æ˜</h2>
<p>æœ¬æ–‡ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹ï¼Œä¸æœ¬äººæ‰€ä¾›èŒçš„å…¬å¸æ— ä»»ä½•å…³ç³»ã€‚</p>
<hr>
<p></p>
<blockquote>
<p><a href="https://emn178.github.io/online-tools/sha256_checksum.html" target="_blank" rel="noopener noreffer ">SHA256</a> checksum: f2fe1394e4ab9297ed69ff73ac32e9ac1375f01c2102183b509bf9379a5995d6</p>
</blockquote>
<h2 id="èµåŠ©">èµåŠ©</h2>
<p></p>
<blockquote>
<p><a href="https://emn178.github.io/online-tools/sha256_checksum.html" target="_blank" rel="noopener noreffer ">SHA256</a> checksum: 964978ecd2059064abe542e51dc02e204d3ee2e6c320ca68e2b1399ce0c6953c</p>
</blockquote>
<blockquote>
<p>ä½¿ç”¨æ­¤ <a href="https://guzhongren.github.io/images/pay/payforguzhongren.svg.sig" target="_blank" rel="noopener noreffer ">æ–‡ä»¶</a> è¿›è¡Œæ ¡éªŒï¼š <code>gpg --verify PayForGuzhongren.svg.sig</code></p>
</blockquote>
]]></description></item></channel></rss>