<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Continuously Optimize Your Website With Lighthouse CI - 谷中仁的博客</title><meta name=Description content="最近的总结或者思考..."><meta property="og:url" content="https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/">
<meta property="og:site_name" content="谷中仁的博客"><meta property="og:title" content="Continuously Optimize Your Website With Lighthouse CI"><meta property="og:description" content="Performance has directly impacted the company’s bottom line. – Pinterest[1] Intro Since the development of the Internet, web page performance has always been an important issue. All major Internet companies are sparing no effort to optimize their web pages, in order to allow users to see the content that users want to see faster.
During the development of the Internet in recent decades, various indicators and terms for measuring web performance have stabilized, and the measurement methods of various products have tended to be consistent."><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-16T14:11:32+08:00"><meta property="article:modified_time" content="2025-08-04T16:04:16+08:00"><meta property="article:tag" content="Lhci"><meta property="article:tag" content="Lighthouse"><meta property="article:tag" content="CI"><meta property="article:tag" content="CD"><meta property="article:tag" content="Performance"><meta property="article:tag" content="Webpref"><meta property="og:image" content="https://guzhongren.github.io/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://guzhongren.github.io/"><meta name=twitter:title content="Continuously Optimize Your Website With Lighthouse CI"><meta name=twitter:description content="Performance has directly impacted the company’s bottom line. – Pinterest[1] Intro Since the development of the Internet, web page performance has always been an important issue. All major Internet companies are sparing no effort to optimize their web pages, in order to allow users to see the content that users want to see faster.
During the development of the Internet in recent decades, various indicators and terms for measuring web performance have stabilized, and the measurement methods of various products have tended to be consistent."><meta name=application-name content="谷中仁的博客"><meta name=apple-mobile-web-app-title content="谷中仁的博客"><meta name=referrer content="no-referrer"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/><link rel=prev href=https://guzhongren.github.io/2022/03/%E4%BD%BF%E7%94%A8-lighthouse-%E6%8C%81%E7%BB%AD%E4%BC%98%E5%8C%96%E4%BD%A0%E7%9A%84-web-%E6%80%A7%E8%83%BD/><link rel=next href=https://guzhongren.github.io/2022/06/%E7%9C%9F%E7%9A%84%E9%9C%80%E8%A6%81%E5%9C%A8%E6%B5%8B%E8%AF%95%E4%B8%AD%E6%89%93log%E4%B9%88/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Continuously Optimize Your Website With Lighthouse CI","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/guzhongren.github.io\/2022\/04\/continuously-optimize-your-website-with-lighthouse-ci\/"},"image":["https:\/\/guzhongren.github.io\/images\/avatar.png"],"genre":"posts","keywords":"lhci, Lighthouse, CI, CD, Performance, Webpref","wordcount":1300,"url":"https:\/\/guzhongren.github.io\/2022\/04\/continuously-optimize-your-website-with-lighthouse-ci\/","datePublished":"2022-04-16T14:11:32+08:00","dateModified":"2025-08-04T16:04:16+08:00","license":"Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"guzhongren","logo":"https:\/\/guzhongren.github.io\/logo.png"},"author":{"@type":"Person","name":"谷中仁"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script>const query=window.matchMedia("(prefers-color-scheme: dark)");function applyTheme(){let e=window.localStorage?.getItem("theme")||"auto",t=e==="dark"||e==="auto"&&query.matches;document.body.setAttribute("theme",t?"dark":"light"),document.body.setAttribute("cfg-theme",e)}applyTheme(),query.addEventListener("change",applyTheme)</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=谷中仁的博客><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/avatar.svg data-srcset="/images/avatar.svg, /images/avatar.svg 1.5x, /images/avatar.svg 2x" data-sizes=auto alt=/images/avatar.svg title=/images/avatar.svg>谷中仁的博客</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/ title=Tags>Tags </a><a class=menu-item href=/categories/ title=Categories>Categories </a><a class=menu-item href=/slides/ title=Slides>Slides </a><a class=menu-item href="https://www.figma.com/file/7EzjLtMRXKcaJrGEmudLwC/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1?node-id=0%3A1" title=知识图谱 rel="noopener noreffer" target=_blank>知识图谱 </a><a class=menu-item href=/about/ title=关于>关于 </a><a class=menu-item href=https://github.com/guzhongren title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> GitHub </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=谷中仁的博客><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/avatar.svg data-srcset="/images/avatar.svg, /images/avatar.svg 1.5x, /images/avatar.svg 2x" data-sizes=auto alt=/images/avatar.svg title=/images/avatar.svg>谷中仁的博客</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title=Tags>Tags</a><a class=menu-item href=/categories/ title=Categories>Categories</a><a class=menu-item href=/slides/ title=Slides>Slides</a><a class=menu-item href="https://www.figma.com/file/7EzjLtMRXKcaJrGEmudLwC/%E7%9F%A5%E8%AF%86%E5%9B%BE%E8%B0%B1?node-id=0%3A1" title=知识图谱 rel="noopener noreffer" target=_blank>知识图谱</a><a class=menu-item href=/about/ title=关于>关于</a><a class=menu-item href=https://github.com/guzhongren title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i>GitHub</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Continuously Optimize Your Website With Lighthouse CI</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://guzhongren.github.io title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>谷中仁</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/tool/><i class="far fa-folder fa-fw" aria-hidden=true></i>Tool</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-04-16>2022-04-16</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 1300 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 3 分钟&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/Lighthouse-Chrome-DevTools.47rhl099s9c0.webp data-srcset="https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/Lighthouse-Chrome-DevTools.47rhl099s9c0.webp, https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/Lighthouse-Chrome-DevTools.47rhl099s9c0.webp 1.5x, https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/Lighthouse-Chrome-DevTools.47rhl099s9c0.webp 2x" data-sizes=auto alt=https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/Lighthouse-Chrome-DevTools.47rhl099s9c0.webp title=https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/Lighthouse-Chrome-DevTools.47rhl099s9c0.webp></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#problems-with-measuring-web-performance>Problems with measuring web performance</a><ul><li><a href=#not-runnable-natively-to-catch-performance-issues-as-early-as-possible>Not runnable natively to catch performance issues as early as possible</a></li><li><a href=#inability-to-continuously-measure-performance-metrics>Inability to continuously measure performance metrics</a></li><li><a href=#cost>Cost</a></li><li><a href=#difficulty-with-ci-integration>Difficulty with CI integration</a></li></ul></li><li><a href=#lighthouse>Lighthouse</a></li><li><a href=#ways-of-lighthouse-ci-and-lighthouse-server>Ways of Lighthouse CI and Lighthouse Server</a><ul><li><a href=#lighthouse-ci-lhci>Lighthouse CI （LHCI）</a><ul><li><a href=#how-to-use>How to use</a></li></ul></li><li><a href=#lighthouse-server>Lighthouse Server</a><ul><li><a href=#installation-and-use-of-lhci-server>Installation and use of LHCI Server</a></li></ul></li><li><a href=#integration-with-lighthouse-ci-and-lighthouse-server>Integration with Lighthouse CI and Lighthouse Server</a></li></ul></li><li><a href=#summary>Summary</a></li></ul></nav></div></div><div class=content id=content><blockquote><p>Performance has directly impacted the company&rsquo;s bottom line.
&ndash; <a href="https://www.youtube.com/watch?v=Xryhxi45Q5M&amp;feature=youtu.be&amp;t=1366">Pinterest</a><sup>[1]</sup></p></blockquote><h2 id=intro>Intro</h2><p>Since the development of the Internet, web page performance has always been an important issue. All major Internet companies are sparing no effort to optimize their web pages, in order to allow users to see the content that users want to see faster.</p><p>During the development of the Internet in recent decades, various indicators and terms for measuring web performance have stabilized, and the measurement methods of various products have tended to be consistent.</p><p>The BBC found that every 1 second increase in the load time of its website was associated with losing 10% more users.
DoubleClick by Google found that 53% of mobile site visits are abandoned if a page takes longer than 3 seconds to load.
DoubleClick by Google research shows that sites with loading times under 5 seconds experience 70% longer sessions, 35% lower bounce rates, and 25% higher ad viewability rates than sites that load about four times as long (19 seconds).
Mobify saw a 1.11% increase in session-based conversions for every 100 milliseconds decrease in homepage load time and an average annual revenue increase of nearly $380,000.
AutoAnything saw a 12-13% increase in sales after halving its page load time.
It can be seen how important the performance of web pages is in today&rsquo;s Internet of Everything era.</p><h2 id=problems-with-measuring-web-performance>Problems with measuring web performance</h2><h3 id=not-runnable-natively-to-catch-performance-issues-as-early-as-possible>Not runnable natively to catch performance issues as early as possible</h3><p>Many tools cannot be run locally; if the web performance testing tools can be run locally, developers can find problems earlier and solve them locally as soon as possible, avoiding running on CI for a while before finding problems , which can save a lot of time and improve production efficiency in the agile development process of <code>CI/CD</code>. <code>Shift-left of the web performance test</code> is bound to bring more benefits to the performance of web products, and even more profits for the company.</p><h3 id=inability-to-continuously-measure-performance-metrics>Inability to continuously measure performance metrics</h3><p>At present, most of the web performance measurement products on the market are <code>Sass</code> products. Using its products, we can only get a visual result page after running the performance test, but it cannot continuously record the improvement records of web page performance, and cannot be well quantified the life cycle of a web product performance. Of course there are also web performance testing tools that implement history, such as <a href=https://treo.sh/>treo</a><sup>[2]</sup>
.</p><h3 id=cost>Cost</h3><p>There are many open source free web performance testing tools, but they may not be so easy to use; if you need more features, such as continuous recording of web page performance, generally only commercial products will support it, and the fees are not low.</p><h3 id=difficulty-with-ci-integration>Difficulty with CI integration</h3><p>As mentioned earlier, many tools either cannot be run locally or are Sass products, which cannot be well integrated with Pipeline, resulting in long feedback cycles of web performance results and make the engineering efficiency too low.</p><h2 id=lighthouse>Lighthouse</h2><blockquote><p>Lighthouse is an open-source, automated tool for improving the quality of web pages. You can run it against any web page, public or requiring authentication. It has audits for performance, accessibility, progressive web apps, SEO and more.</p></blockquote><blockquote><p>You can run Lighthouse in <code>Chrome DevTools</code>, from the command line, or as a <code>Node</code> module. You give <code>Lighthouse</code> a URL to audit, it runs a series of audits against the page, and then it generates a report on how well the page did. From there, use the failing audits as indicators on how to improve the page. Each audit has a reference doc explaining why the audit is important, as well as how to fix it.</p></blockquote><blockquote><p>You can also use Lighthouse CI to prevent regressions on your sites.</p></blockquote><p>It&rsquo;s very easy to use, take a look at the results of my audit of my open source project <a href=https://github.com/guzhongren/Powerboard>Powerboard</a><sup>[3]</sup>
.
<img src=https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/Lighthouse-Chrome-DevTools.47rhl099s9c0.webp alt=Lighthouse-Chrome-DevTools></p><h2 id=ways-of-lighthouse-ci-and-lighthouse-server>Ways of Lighthouse CI and Lighthouse Server</h2><h3 id=lighthouse-ci-lhci>Lighthouse CI （LHCI）</h3><blockquote><p>Automate running Lighthouse for every commit, viewing the changes, and preventing regressions
&ndash; <a href=https://github.com/GoogleChrome/lighthouse-ci>GoogleChrome/lighthouse-ci</a><sup>[4]</sup></p></blockquote><p><code>Lighthouse CI</code> is a suite of tools that make continuously running, saving, retrieving, and asserting against Lighthouse results as easy as possible.</p><h4 id=how-to-use>How to use</h4><p><code>LHCI</code> provides the <code>npm</code> installation package, which can be well integrated on the Pipeline, just run the <code>autorun</code> command in the corresponding directory, the command is as follows</p><div class="code-block code-line-numbers open" style="counter-reset:code-block 0"><div class="code-header language-shell"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>npm install -g @lhci/cli
</span></span><span class=line><span class=cl>lhci autorun</span></span></code></pre></div></div><p>After the operation is completed, LHCI will store the results in the <code>.lighthouseci</code> directory, and you can open the corresponding report with a browser.</p><h3 id=lighthouse-server>Lighthouse Server</h3><blockquote><p>The LHCI server saves historical Lighthouse data, displays trends in a dashboard, and offers an in-depth build comparison UI to uncover differences between builds.</p></blockquote><table><thead><tr><th><img src=https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/lhci-server.5x95meg6f4w0.webp alt=lhci-server></th><th><img src=https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/lhci-server-compare.64ass32uxhg0.webp alt=lhci-server-compare></th></tr></thead><tbody></tbody></table><h4 id=installation-and-use-of-lhci-server>Installation and use of LHCI Server</h4><p>There are many ways to install LHCI Server, please refer to <a href=https://github.com/GoogleChrome/lighthouse-ci/blob/main/docs/server.md#lhci-server>here</a><sup>[5]</sup>
, the recommended way is to use Docker. Note that the first run needs to create a Lighthouse App, you need to run the <code>lhci wizard</code> in the container and fill in the corresponding information, <strong>finally record the generated <code>Build token</code> and <code>Admin token</code></strong>.</p><h3 id=integration-with-lighthouse-ci-and-lighthouse-server>Integration with Lighthouse CI and Lighthouse Server</h3><p><img src=https://user-images.githubusercontent.com/2301202/81843922-f2e17300-9513-11ea-85f9-d3d8a0b52633.png alt="Lighthouse CI Recommended Setup Progression"></p><ul><li>We have already talked about how to install <code>lhci</code> and <code>lhci server</code>, the next step is to use the two together. Here we take <code>GitHub Actions</code> as an example to make a demo.</li><li>Build <code>GitHub workflow</code>. For specific practices, please refer to the implementation details of <a href=https://github.com/guzhongren/Powerboard>Powerboard</a><sup>[3]</sup></li><li>.github/workflows/Lighthouse.yml</li></ul><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-yml"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Lighthouse CI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>push</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>branches</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>main</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jobs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>lhci</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Lighthouse</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu-latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/checkout@v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ref</span><span class=p>:</span><span class=w> </span><span class=l>${{ github.event.pull_request.head.sha }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Use Node.js 10.x</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>uses</span><span class=p>:</span><span class=w> </span><span class=l>actions/setup-node@v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>with</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>node-version</span><span class=p>:</span><span class=w> </span><span class=m>16.14.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>npm install, build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          npm install
</span></span></span><span class=line><span class=cl><span class=sd>          npm run build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Upload Lighthouse Report</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          npm install -g @lhci/cli
</span></span></span><span class=line><span class=cl><span class=sd>          lhci autorun --config=.github/config/lighthouserc-no-condition.json
</span></span></span><span class=line><span class=cl><span class=sd>          lhci upload --serverBaseUrl=${{ secrets.LHCI_SERVER_URL }} --token=${{ secrets.LHCI_BUILD_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>LHCI_GITHUB_APP_TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${{ secrets.LHCI_GITHUB_APP_TOKEN }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Check Lighthouse Report</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>          lhci autorun --config=.github/config/lighthouserc.json</span></span></span></code></pre></div></div><ul><li>.github/config/lighthouserc-no-condition.json</li></ul><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-json"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;ci&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;collect&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;staticDistDir&#34;</span><span class=p>:</span> <span class=s2>&#34;./dist&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;settings&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;formFactor&#34;</span><span class=p>:</span> <span class=s2>&#34;desktop&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;screenEmulation&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;mobile&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;width&#34;</span><span class=p>:</span> <span class=mi>1920</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;height&#34;</span><span class=p>:</span> <span class=mi>1080</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;deviceScaleFactor&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;disabled&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;assert&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;assertions&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:performance&#34;</span><span class=p>:</span> <span class=s2>&#34;off&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:accessibility&#34;</span><span class=p>:</span> <span class=s2>&#34;off&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:best-practices&#34;</span><span class=p>:</span> <span class=s2>&#34;off&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:seo&#34;</span><span class=p>:</span> <span class=s2>&#34;off&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:pwa&#34;</span><span class=p>:</span> <span class=s2>&#34;off&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><ul><li>.github/config/lighthouserc.json</li></ul><div class="code-block code-line-numbers" style="counter-reset:code-block 0"><div class="code-header language-json"><span class=code-title><i class="arrow fas fa-angle-right fa-fw" aria-hidden=true></i></span>
<span class=ellipses><i class="fas fa-ellipsis-h fa-fw" aria-hidden=true></i></span>
<span class=copy title=复制到剪贴板><i class="far fa-copy fa-fw" aria-hidden=true></i></span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;ci&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;collect&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;staticDistDir&#34;</span><span class=p>:</span> <span class=s2>&#34;./dist&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;settings&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;formFactor&#34;</span><span class=p>:</span> <span class=s2>&#34;desktop&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;screenEmulation&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;mobile&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;width&#34;</span><span class=p>:</span> <span class=mi>1920</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;height&#34;</span><span class=p>:</span> <span class=mi>1080</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;deviceScaleFactor&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nt>&#34;disabled&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;assert&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;assertions&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:performance&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;error&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nt>&#34;minScore&#34;</span><span class=p>:</span> <span class=mf>0.8</span> <span class=p>}],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:accessibility&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;error&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nt>&#34;minScore&#34;</span><span class=p>:</span> <span class=mf>0.95</span> <span class=p>}],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:best-practices&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;error&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nt>&#34;minScore&#34;</span><span class=p>:</span> <span class=mi>1</span> <span class=p>}],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:seo&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;error&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nt>&#34;minScore&#34;</span><span class=p>:</span> <span class=mf>0.9</span> <span class=p>}],</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;categories:pwa&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;warn&#34;</span><span class=p>,</span> <span class=p>{</span> <span class=nt>&#34;minScore&#34;</span><span class=p>:</span> <span class=mf>0.99</span> <span class=p>}]</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div><ul><li>Need to store the <code>Build token</code> generated by <code>lhci Server</code> and the address of <code>lhci Server</code> in the Secrets of the GitHub project</li><li>Here the <code>lhci</code> command is executed twice. Because <code>lhci autorun</code> runs the default <code>assertion</code>, the first time you use the command without assertion, the purpose is to upload the current web page performance to the server side; the second time you configure various indicators Threshold, if it does not meet the requirements, Pipeline will block, to achieve <code>Shift-left of the web performance test</code>.</li><li><img src=https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/powerboard-lighthouse-actions.40eis8x91cu0.webp alt="Powerboard Lighthouse Actions"></li></ul><h2 id=summary>Summary</h2><ul><li>For: Developers, technical leads or marketers</li><li>They want to: <code>continuously quantify</code> and demonstrate the <code>performance</code> of web pages</li><li>This: Lighthouse CI</li><li>is one: a set of tools written by <code>Google</code> to make it as easy as possible to continuously run, save, retrieve, and assert on <code>Lighthouse</code> results. It can evaluate web applications and pages, as well as gather information such as performance metrics and insights from development best practices</li><li>It can: test your web page, get web page&rsquo;s <code>Performance</code> , <code>Accessibility</code> , <code>Best Practices</code> , <code>SEO</code> and <code>PWA</code> scores on different <code>devices</code>, these scores can be used to analyze the product performance, helping to improve user conversion rates, etc.</li><li>Unlike: <a href=https://treo.sh/>treo</a><sup>[2]</sup>
or some other web performance testing tool</li><li>Its advantages are: <code>Open-Source</code>, <code>Free</code>, <code>Self-hosted</code> data and Server, <code>Easy to integrate</code>.</li></ul></div><div class=references><h2>参考</h2><ol><li>Pinterest: <a href="https://www.youtube.com/watch?v=Xryhxi45Q5M&amp;feature=youtu.be&amp;t=1366" target=_blank rel="noopener noreferrer">https://www.youtube.com/watch?v=Xryhxi45Q5M&amp;feature=youtu.be&amp;t=1366</a></li><li>treo: <a href=https://treo.sh/ target=_blank rel="noopener noreferrer">https://treo.sh/</a></li><li>Powerboard: <a href=https://github.com/guzhongren/Powerboard target=_blank rel="noopener noreferrer">https://github.com/guzhongren/Powerboard</a></li><li>GoogleChrome/lighthouse-ci: <a href=https://github.com/GoogleChrome/lighthouse-ci target=_blank rel="noopener noreferrer">https://github.com/GoogleChrome/lighthouse-ci</a></li><li>here: <a href=https://github.com/GoogleChrome/lighthouse-ci/blob/main/docs/server.md#lhci-server target=_blank rel="noopener noreferrer">https://github.com/GoogleChrome/lighthouse-ci/blob/main/docs/server.md#lhci-server</a></li></ol></div><div class=disclaimer><h2>免责声明</h2><p>本文仅代表个人观点，与本人所供职的公司无任何关系。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2025-08-04&nbsp;<a class=git-hash href=https://github.com/guzhongren/guzhongren.github.io/commit/b7c8b45b49b01fea96cac51c333df41169625f46 target=_blank title="commit by guzhongren(guzhongren@live.cn) b7c8b45b49b01fea96cac51c333df41169625f46: docs: remove ref">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>b7c8b45</a></span></div><div class=post-info-license><span><a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/><img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-nc/4.0/80x15.png></a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/2022/04/continuously-optimize-your-website-with-lighthouse-ci/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=x data-url=https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/ data-title="Continuously Optimize Your Website With Lighthouse CI" data-via=guzhongren data-hashtags=lhci,Lighthouse,CI,CD,Performance,Webpref><i class="fab fa-x-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Threads" data-sharer=threads data-url=https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/ data-title="Continuously Optimize Your Website With Lighthouse CI"><i class="fab fa-threads fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/ data-hashtag=lhci><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/ data-title="Continuously Optimize Your Website With Lighthouse CI"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/ data-title="Continuously Optimize Your Website With Lighthouse CI"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@15.14.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/ data-title="Continuously Optimize Your Website With Lighthouse CI" data-image=https://cdn.jsdelivr.net/gh/guzhongren/picx-images-hosting@master/Tools/Lighthouse/Lighthouse-Chrome-DevTools.47rhl099s9c0.webp><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Diaspora" data-sharer=diaspora data-url=https://guzhongren.github.io/2022/04/continuously-optimize-your-website-with-lighthouse-ci/ data-title="Continuously Optimize Your Website With Lighthouse CI" data-description><i class="fab fa-diaspora fa-fw" aria-hidden=true></i></a><a href="https://t.me/share/url?url=https%3a%2f%2fguzhongren.github.io%2f2022%2f04%2fcontinuously-optimize-your-website-with-lighthouse-ci%2f&amp;text=Continuously%20Optimize%20Your%20Website%20With%20Lighthouse%20CI" target=_blank title="分享到 Telegram"><i class="fab fa-telegram fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/lhci/>Lhci</a>,&nbsp;<a href=/tags/lighthouse/>Lighthouse</a>,&nbsp;<a href=/tags/ci/>CI</a>,&nbsp;<a href=/tags/cd/>CD</a>,&nbsp;<a href=/tags/performance/>Performance</a>,&nbsp;<a href=/tags/webpref/>Webpref</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2022/03/%E4%BD%BF%E7%94%A8-lighthouse-%E6%8C%81%E7%BB%AD%E4%BC%98%E5%8C%96%E4%BD%A0%E7%9A%84-web-%E6%80%A7%E8%83%BD/ class=prev rel=prev title="使用 Lighthouse 持续优化你的 Web 性能"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>使用 Lighthouse 持续优化你的 Web 性能</a>
<a href=/2022/06/%E7%9C%9F%E7%9A%84%E9%9C%80%E8%A6%81%E5%9C%A8%E6%B5%8B%E8%AF%95%E4%B8%AD%E6%89%93log%E4%B9%88/ class=next rel=next title=真的需要在测试中打log么？>真的需要在测试中打log么？<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=utterances class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>友情链接:<div style=display:flex;justify-content:center;align-items:center><a style="display:flex;justify-content:center;align-items:center;margin:0 1rem" href=https://yihaimen.github.io><span style=display:flex;justify-content:center;align-items:center><img style=height:24px src=https://yihaimen.github.io/images/avatar.png><span>易海门的博客</span></span></a><a style="display:flex;justify-content:center;align-items:center;margin:0 1rem" href=https://bytewars.cc><span style=display:flex;justify-content:center;align-items:center><img style=height:24px src=https://bytewars.github.io/images/avatar.png><span>ByteWars社区</span></span></a></div></div><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.145.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2020 - 2026</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=guzhongren@live.cn target=_blank>谷中仁</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i></a></div><div id=fixed-buttons-hidden><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script src=https://cdn.jsdelivr.net/npm/algoliasearch@5.20.2/dist/lite/builds/browser.umd.min.js></script><script src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.2/sharer.min.js></script><script>window.config={comment:{utterances:{darkTheme:"github-dark",issueTerm:"title",label:"utterances",lightTheme:"github-light",repo:"guzhongren/guzhongren.github.io"}},search:{algoliaAppID:"8FBSWQTAD1",algoliaIndex:"index.zh-cn",algoliaSearchKey:"f8e94db6f14a6320dcdcb4db3f7256aa",highlightTag:"em",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:30,type:"algolia"},twemoji:!0}</script><script src=/js/theme.min.js></script></body></html>